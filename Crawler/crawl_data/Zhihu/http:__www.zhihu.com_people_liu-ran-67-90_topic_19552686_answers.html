<!DOCTYPE html><html lang="zh-CN" dropEffect="none" class="no-js no-auth "><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="renderer" content="webkit" /><title> 刘然 在话题 操作系统 下的回答 - 知乎</title><meta name="apple-itunes-app" content="app-id=432274380, app-argument=zhihu://people/liu-ran-67-90"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/><meta http-equiv="mobile-agent" content="format=html5;url=http://www.zhihu.com/people/liu-ran-67-90/topic/19552686/answers"><meta id="znonce" name="znonce" content="07e06b85c1c8417abb4203024c9819b1"><link rel="apple-touch-icon-precomposed" href="http://static.zhihu.com/static/img/ios/zhihu(57px).png" /><link rel="apple-touch-icon-precomposed" href="http://static.zhihu.com/static/img/ios/zhihu(72px).png" sizes="72x72" /><link rel="apple-touch-icon-precomposed" href="http://static.zhihu.com/static/img/ios/zhihu(76px).png" sizes="76x76" /><link rel="apple-touch-icon-precomposed" href="http://static.zhihu.com/static/img/ios/zhihu(114px).png" sizes="114x114" /><link rel="apple-touch-icon-precomposed" href="http://static.zhihu.com/static/img/ios/zhihu(120px).png" sizes="120x120" /><link rel="apple-touch-icon-precomposed" href="http://static.zhihu.com/static/img/ios/zhihu(152px).png" sizes="152x152" /><link rel="shortcut icon" href="http://static.zhihu.com/static/favicon.ico" type="image/x-icon"><link rel="search" type="application/opensearchdescription+xml" href="http://static.zhihu.com/static/search.xml" title="知乎" /><link rel="stylesheet" href="http://static.zhihu.com/static/revved/-/css/z.e721bf59.css"><link rel="stylesheet" href="http://static.zhihu.com/static/revved/-/css/pages/profile/main.d288b7b1.css"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg" /><meta property="qc:admins" content="14414345146201056375" /><!--[if lt IE 9]><script src="http://static.zhihu.com/static/components/respond/dest/respond.min.js"></script><link href="http://static.zhihu.com/static/components/respond/cross-domain/respond-proxy.html" id="respond-proxy" rel="respond-proxy" /><link href="/static/components/respond/cross-domain/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" /><script src="/static/components/respond/cross-domain/respond.proxy.js"></script><![endif]--><script src="http://static.zhihu.com/static/revved/-/js/instant.4b42dd60.js"></script><style>.zm-item-top-container{display:none;}</style><link rel="canonical" href="http://www.zhihu.com/people/liu-ran-67-90" /></head><body class="zhi "><div role="navigation" class="zu-top"><div class="zg-wrap modal-shifting clearfix" id="zh-top-inner"><a href="/" class="zu-top-link-logo" id="zh-top-link-logo" data-za-c="view_home" data-za-a="visit_home" data-za-l="top_navigation_zhihu_logo">知乎</a><ul class="topnav-noauth clearfix"><li><a href="javascript:;" class="js-signup-noauth"><i class="zg-icon zg-icon-dd-home"></i>注册知乎</a></li><li><a href="javascript:;" class="js-signin-noauth">登录</a></li></ul><button class="zu-top-add-question" id="zu-top-add-question">提问</button><div role="search" id="zh-top-search" class="zu-top-search"><form method="GET" action="/search" id="zh-top-search-form" class="zu-top-search-form"><input type="hidden" name="type" value="question"><label for="q" class="hide-text">知乎搜索</label><input type="text" class="zu-top-search-input" id="q" name="q" autocomplete="off" value="" placeholder="搜索问题、话题或人"><button type="submit" class="zu-top-search-button"><span class="hide-text">搜索</span><span class="sprite-global-icon-magnifier-dark"></span></button></form></div><div id="zg-top-nav" class="zu-top-nav"><ul class="zu-top-nav-ul zg-clear"><li class="zu-top-nav-li " id="zh-top-nav-home"><a class="zu-top-nav-link" href="/" id="zh-top-link-home" data-za-c="view_home" data-za-a="visit_home" data-za-l="top_navigation_home">首页</a></li><li class="top-nav-topic-selector zu-top-nav-li " id="zh-top-nav-topic"><a class="zu-top-nav-link" href="/topic" id="top-nav-dd-topic">话题</a></li><li class="zu-top-nav-li " id="zh-top-nav-explore"><a class="zu-top-nav-link" href="/explore">发现</a></li></ul><div class="zu-top-nav-live zu-noti7-popup zg-r5px no-hovercard" id="zh-top-nav-live-new" role="popup" tabindex="0"><div class="zu-top-nav-live-inner zg-r5px"><div class="zu-top-live-icon">&nbsp;</div><div class="zu-home-noti-inner" id="zh-top-nav-live-new-inner"><div class="zm-noti7-popup-tab-container clearfix" tabindex="0"><button class="zm-noti7-popup-tab-item message"><span class="icon">消息</span></button><button class="zm-noti7-popup-tab-item user"><span class="icon">用户</span></button><button class="zm-noti7-popup-tab-item thanks"><span class="icon">赞同和感谢</span></button></div></div><div class="zm-noti7-frame-border top"></div><div class="zm-noti7-frame"><div class="zm-noti7-content"><div class="zm-noti7-content-inner"><div class="zm-noti7-content-body"><div class="zm-noti7-popup-loading"><span class="noti-spinner-loading"></span></div></div></div></div><div class="zm-noti7-content" style="display:none;"><div class="zm-noti7-content-inner"><div class="zm-noti7-content-body"><div class="zm-noti7-popup-loading"><span class="noti-spinner-loading"></span></div></div></div></div><div class="zm-noti7-content" style="display:none;"><div class="zm-noti7-content-inner"><div class="zm-noti7-content-body"><div class="zm-noti7-popup-loading"><span class="noti-spinner-loading"></span></div></div></div></div></div><div class="zm-noti7-frame-border bottom"></div><div class="zm-noti7-popup-footer"><a href="/notifications" class="zm-noti7-popup-footer-all zg-right">查看全部 &raquo;</a><a href="/settings/notification" class="zm-noti7-popup-footer-set" title="通知设置" ><i class="zg-icon zg-icon-settings"></i></a></div></div></div></div></div></div><div class="zu-global-notify" id="zh-global-message" style="display:none"><div class="zg-wrap"><div class="zu-global-nitify-inner"><a class="zu-global-notify-close" href="javascript:;" title="关闭" name="close">x</a><span class="zu-global-notify-icon"></span><span class="zu-global-notify-msg"></span></div></div></div><div class="zg-wrap zu-main clearfix "  role="main"><div class="zu-main-content"><div class="zu-main-content-inner"><div class="zm-profile-header"><div class="zm-profile-header-main"><div class="top"><div class="title-section ellipsis"><a class="name" href="/people/liu-ran-67-90">刘然</a>，<span class="bio" title="知我者谓我心忧">知我者谓我心忧</span></div></div><div class="body clearfix"><div class="zm-profile-header-avatar-container "><img class="avatar avatar-l" alt="刘然" src="https://pic1.zhimg.com/b53c5a354_l.jpg" srcset="https://pic1.zhimg.com/b53c5a354_xl.jpg 2x" /></div><div class="zm-profile-header-info"><div class="zm-profile-header-user-describe"><div class="items"><div class="item editable-group" data-name="location"><i class="icon icon-profile-location"></i><span class="info-wrap"><span class="location item" title="上海 杭州">上海 杭州</span><span class="business item" title="电子游戏"><a href="/topic/19554169" title="电子游戏" class="topic-link" data-token="19554169" data-topicid="1314">电子游戏</a></span><span class="item gender" ><i class="icon icon-profile-male"></i></span></span><span class="edit-wrap" style="display:none;"><span class="topic-input-wrap"><input autocomplete="off" aria-haspopup="true" type="text" name="location" value="上海 杭州" class="zg-form-text-input location" placeholder="居住地"/></span><div class="business-selection"><select name="business"><option value="">选择行业</option><option value="高新科技">高新科技</option><option value="互联网">&nbsp;&nbsp;&nbsp;互联网</option><option value="电子商务">&nbsp;&nbsp;&nbsp;电子商务</option><option value="电子游戏" selected>&nbsp;&nbsp;&nbsp;电子游戏</option><option value="计算机软件">&nbsp;&nbsp;&nbsp;计算机软件</option><option value="计算机硬件">&nbsp;&nbsp;&nbsp;计算机硬件</option><option value="信息传媒">信息传媒</option><option value="出版业">&nbsp;&nbsp;&nbsp;出版业</option><option value="电影录音">&nbsp;&nbsp;&nbsp;电影录音</option><option value="广播电视">&nbsp;&nbsp;&nbsp;广播电视</option><option value="通信">&nbsp;&nbsp;&nbsp;通信</option><option value="金融">金融</option><option value="银行">&nbsp;&nbsp;&nbsp;银行</option><option value="资本投资">&nbsp;&nbsp;&nbsp;资本投资</option><option value="证券投资">&nbsp;&nbsp;&nbsp;证券投资</option><option value="保险">&nbsp;&nbsp;&nbsp;保险</option><option value="信贷">&nbsp;&nbsp;&nbsp;信贷</option><option value="财务">&nbsp;&nbsp;&nbsp;财务</option><option value="审计">&nbsp;&nbsp;&nbsp;审计</option><option value="服务业">服务业</option><option value="法律">&nbsp;&nbsp;&nbsp;法律</option><option value="餐饮">&nbsp;&nbsp;&nbsp;餐饮</option><option value="酒店">&nbsp;&nbsp;&nbsp;酒店</option><option value="旅游">&nbsp;&nbsp;&nbsp;旅游</option><option value="广告">&nbsp;&nbsp;&nbsp;广告</option><option value="公关">&nbsp;&nbsp;&nbsp;公关</option><option value="景观">&nbsp;&nbsp;&nbsp;景观</option><option value="咨询分析">&nbsp;&nbsp;&nbsp;咨询分析</option><option value="市场推广">&nbsp;&nbsp;&nbsp;市场推广</option><option value="人力资源">&nbsp;&nbsp;&nbsp;人力资源</option><option value="社工服务">&nbsp;&nbsp;&nbsp;社工服务</option><option value="养老服务">&nbsp;&nbsp;&nbsp;养老服务</option><option value="教育">教育</option><option value="高等教育">&nbsp;&nbsp;&nbsp;高等教育</option><option value="基础教育">&nbsp;&nbsp;&nbsp;基础教育</option><option value="职业教育">&nbsp;&nbsp;&nbsp;职业教育</option><option value="幼儿教育">&nbsp;&nbsp;&nbsp;幼儿教育</option><option value="特殊教育">&nbsp;&nbsp;&nbsp;特殊教育</option><option value="培训">&nbsp;&nbsp;&nbsp;培训</option><option value="医疗服务">医疗服务</option><option value="临床医疗">&nbsp;&nbsp;&nbsp;临床医疗</option><option value="制药">&nbsp;&nbsp;&nbsp;制药</option><option value="保健">&nbsp;&nbsp;&nbsp;保健</option><option value="美容">&nbsp;&nbsp;&nbsp;美容</option><option value="医疗器材">&nbsp;&nbsp;&nbsp;医疗器材</option><option value="生物工程">&nbsp;&nbsp;&nbsp;生物工程</option><option value="疗养服务">&nbsp;&nbsp;&nbsp;疗养服务</option><option value="护理服务">&nbsp;&nbsp;&nbsp;护理服务</option><option value="艺术娱乐">艺术娱乐</option><option value="创意艺术">&nbsp;&nbsp;&nbsp;创意艺术</option><option value="体育健身">&nbsp;&nbsp;&nbsp;体育健身</option><option value="娱乐休闲">&nbsp;&nbsp;&nbsp;娱乐休闲</option><option value="图书馆">&nbsp;&nbsp;&nbsp;图书馆</option><option value="博物馆">&nbsp;&nbsp;&nbsp;博物馆</option><option value="策展">&nbsp;&nbsp;&nbsp;策展</option><option value="博彩">&nbsp;&nbsp;&nbsp;博彩</option><option value="制造加工">制造加工</option><option value="食品饮料业">&nbsp;&nbsp;&nbsp;食品饮料业</option><option value="纺织皮革业">&nbsp;&nbsp;&nbsp;纺织皮革业</option><option value="服装业">&nbsp;&nbsp;&nbsp;服装业</option><option value="烟草业">&nbsp;&nbsp;&nbsp;烟草业</option><option value="造纸业">&nbsp;&nbsp;&nbsp;造纸业</option><option value="印刷业">&nbsp;&nbsp;&nbsp;印刷业</option><option value="化工业">&nbsp;&nbsp;&nbsp;化工业</option><option value="汽车">&nbsp;&nbsp;&nbsp;汽车</option><option value="家具">&nbsp;&nbsp;&nbsp;家具</option><option value="电子电器">&nbsp;&nbsp;&nbsp;电子电器</option><option value="机械设备">&nbsp;&nbsp;&nbsp;机械设备</option><option value="塑料工业">&nbsp;&nbsp;&nbsp;塑料工业</option><option value="金属加工">&nbsp;&nbsp;&nbsp;金属加工</option><option value="军火">&nbsp;&nbsp;&nbsp;军火</option><option value="地产建筑">地产建筑</option><option value="房地产">&nbsp;&nbsp;&nbsp;房地产</option><option value="装饰装潢">&nbsp;&nbsp;&nbsp;装饰装潢</option><option value="物业服务">&nbsp;&nbsp;&nbsp;物业服务</option><option value="特殊建造">&nbsp;&nbsp;&nbsp;特殊建造</option><option value="建筑设备">&nbsp;&nbsp;&nbsp;建筑设备</option><option value="贸易零售">贸易零售</option><option value="零售">&nbsp;&nbsp;&nbsp;零售</option><option value="大宗交易">&nbsp;&nbsp;&nbsp;大宗交易</option><option value="进出口贸易">&nbsp;&nbsp;&nbsp;进出口贸易</option><option value="公共服务">公共服务</option><option value="政府">&nbsp;&nbsp;&nbsp;政府</option><option value="国防军事">&nbsp;&nbsp;&nbsp;国防军事</option><option value="航天">&nbsp;&nbsp;&nbsp;航天</option><option value="科研">&nbsp;&nbsp;&nbsp;科研</option><option value="给排水">&nbsp;&nbsp;&nbsp;给排水</option><option value="水利能源">&nbsp;&nbsp;&nbsp;水利能源</option><option value="电力电网">&nbsp;&nbsp;&nbsp;电力电网</option><option value="公共管理">&nbsp;&nbsp;&nbsp;公共管理</option><option value="环境保护">&nbsp;&nbsp;&nbsp;环境保护</option><option value="非营利组织">&nbsp;&nbsp;&nbsp;非营利组织</option><option value="开采冶金">开采冶金</option><option value="煤炭工业">&nbsp;&nbsp;&nbsp;煤炭工业</option><option value="石油工业">&nbsp;&nbsp;&nbsp;石油工业</option><option value="黑色金属">&nbsp;&nbsp;&nbsp;黑色金属</option><option value="有色金属">&nbsp;&nbsp;&nbsp;有色金属</option><option value="土砂石开采">&nbsp;&nbsp;&nbsp;土砂石开采</option><option value="地热开采">&nbsp;&nbsp;&nbsp;地热开采</option><option value="交通仓储">交通仓储</option><option value="邮政">&nbsp;&nbsp;&nbsp;邮政</option><option value="物流递送">&nbsp;&nbsp;&nbsp;物流递送</option><option value="地面运输">&nbsp;&nbsp;&nbsp;地面运输</option><option value="铁路运输">&nbsp;&nbsp;&nbsp;铁路运输</option><option value="管线运输">&nbsp;&nbsp;&nbsp;管线运输</option><option value="航运业">&nbsp;&nbsp;&nbsp;航运业</option><option value="民用航空业">&nbsp;&nbsp;&nbsp;民用航空业</option><option value="农林牧渔">农林牧渔</option><option value="种植业">&nbsp;&nbsp;&nbsp;种植业</option><option value="畜牧养殖业">&nbsp;&nbsp;&nbsp;畜牧养殖业</option><option value="林业">&nbsp;&nbsp;&nbsp;林业</option><option value="渔业">&nbsp;&nbsp;&nbsp;渔业</option></select></div><span class="zg-bull">|</span><input type="radio" name="gender" value="1" checked="checked" class="male"/> 男&nbsp;&nbsp;<input type="radio" name="gender" value="0"  class="female"/> 女<a class="zg-btn-blue" name="save" href="javascript:;">确定</a></span></div><div class="item editable-group " data-name="employment"><i class="icon icon-profile-company"></i><span class="info-wrap"><span class="employment item" title="网易游戏"><a href="/topic/19669945" title="网易游戏" class="topic-link" data-token="19669945" data-topicid="39998">网易游戏</a></span></span><span class='info-empty-wrap'><a href="javascript:;" name="edit" class="zg-link-litblue-normal">填写工作信息</a></span><span class="edit-wrap" style="display:none;"><span class="topic-input-wrap"><input autocomplete="off" aria-haspopup="true" type="text" name="employment" value="网易游戏" class="zg-form-text-input employment" placeholder="公司或组织名称"/></span><span class="topic-input-wrap"><input autocomplete="off" aria-haspopup="true" type="text" name="position" value="" class="zg-form-text-input position" placeholder="你的职位"/></span><a class="zg-btn-blue" name="save" href="javascript:;">确定</a></span></div><div class="item editable-group " data-name="education" ><i class="icon icon-profile-education"></i><span class="info-wrap"><span class="education item" title="孵蛋大学">孵蛋大学</span></span><span class='info-empty-wrap'><a href="javascript:;" name="edit" class="zg-link-litblue-normal">填写教育信息</a></span><span class="edit-wrap" style="display:none;"><span class="topic-input-wrap"><input autocomplete="off" aria-haspopup="true" type="text" name="education" value="孵蛋大学" class="zg-form-text-input education" placeholder="学校或教育机构"/></span><span class="topic-input-wrap"><input autocomplete="off" aria-haspopup="true" type="text" name="education" value="" class="zg-form-text-input education-extra" placeholder="专业方向"/></span><a class="zg-btn-blue" name="save" href="javascript:;">确定</a></span></div><a class="zm-profile-header-user-detail zg-link-litblue-normal zm-profile-icon-return" href="/people/liu-ran-67-90"><i class="zm-profile-header-icon"></i><span>返回个人主页</span></a></div><div class="zm-profile-header-description editable-group " data-name="description"><span class="info-wrap fold-wrap fold disable-fold"><span class="description unfold-item"><span class="content">码农中的厨子，厨子中的码农</span><a href="javascript:;" name="fold" class="fold collapse meta-item"><i class="z-icon-fold"></i>收起</a></span><span class="fold-item"><span class="content">码农中的厨子，厨子中的码农</span><a href="javascript:;" class="unfold" name="unfold">显示全部 »</a></span></span><span class='info-empty-wrap'><a href="javascript:;" name="edit" class="zg-link-litblue-normal"><i class="zg-icon zg-icon-edit-button-blue"></i>填写个人简介</a></span><span class="edit-wrap" style="display:none;"><div class="zm-editable-editor-outer"><div class="zm-editable-editor-inner zg-form-text-input"><textarea name="description" value="" class="zm-editable-editor-input description" id="profile-header-description-input">码农中的厨子，厨子中的码农</textarea></div></div><a class="zg-btn-blue" name="save" href="javascript:;">确定</a></span></div></div></div></div></div><div class="zm-profile-header-operation zg-clear "><div class="zm-profile-header-info-list"><span class="zm-profile-header-info-title">获得</span><span class="zm-profile-header-user-agree"><span class="zm-profile-header-icon"></span><strong>13034</strong>赞同</span><span class="zm-profile-header-user-thanks"><span class="zm-profile-header-icon"></span><strong>4615</strong>感谢</span></div><div class="zm-profile-header-op-btns clearfix"><button data-follow="m:button" data-id="04fbfba44a869601cfcefa3013c8fcfa" class="zg-btn zg-btn-follow zm-rich-follow-btn">关注他</button><a href="/inbox/9117274300" class="zg-btn-white zm-profile-header-pm-btn" id="zm-profile-header-pm-btn"><i class="zg-icon">私信</i></a></div></div><div class="profile-navbar clearfix"><a class="item home first "href="/people/liu-ran-67-90"><i class="icon icon-profile-tab-home"></i><span class="hide-text">主页</span></a><a class="item "href="/people/liu-ran-67-90/asks">提问<span class="num">6</span></a><a class="item "href="/people/liu-ran-67-90/answers">回答<span class="num">84</span></a><a class="item "href="/people/liu-ran-67-90/posts">专栏文章<span class="num">0</span></a><a class="item "href="/people/liu-ran-67-90/collections">收藏<span class="num">0</span></a><a class="item "href="/people/liu-ran-67-90/logs">公共编辑<span class="num">31</span></a></div></div><div class="zm-profile-section-wrap zm-profile-answer-page"><div class="zm-profile-section-head"><span class="zm-profile-section-name"><a href="/people/liu-ran-67-90">刘然</a> 在 <a href="/topic/19552686">操作系统</a> 话题下的回答（3）</span><a class="zg-right zg-link-litblue-normal zm-profile-answer-page-return" href="/people/liu-ran-67-90">返回个人主页</a></div><div class="zm-profile-section-list"><div id="zh-profile-list-container"><div id="zh-profile-answer-list-outer"><div id="zh-profile-answer-list"><div class="zm-item" id="mi-1434691097"><h2><a class="question_link" href="/question/31325454/answer/51920170">请问，多个线程可以读一个变量，只有一个线程可以对这个变量进行写，到底要不要加锁？</a></h2><div tabindex="-1" class="zm-item-answer "data-aid="16172324"data-atoken="51920170"data-collapsed="0"data-created="1434691097"data-deleted="0"data-isowner="0"data-helpful="1"data-copyable="1"><a class="zg-anchor-hidden" name="answer-16172324"></a><div class="zm-item-vote"><a class="zm-item-vote-count js-expand js-vote-count" href="javascript:;" data-votecount="103">103</a></div><div class="zm-votebar"><button class="up "><i class="icon vote-arrow"></i><span class="count">103</span><span class="label sr-only">赞同</span></button><button class="down "><i class="icon vote-arrow"></i><span class="label sr-only">反对</span></button></div><div class="answer-head"><div class="zm-item-answer-author-info"><a class="zm-item-link-avatar avatar-link" href="/people/liu-ran-67-90" data-tip="p$t$liu-ran-67-90"><img src="https://pic1.zhimg.com/b53c5a354_s.jpg" class="zm-list-avatar avatar"></a><a class="author-link" data-tip="p$t$liu-ran-67-90" href="/people/liu-ran-67-90">刘然</a>，<span title="Kernel Hacker" class="bio">Kernel Hacker</span></div><div class="zm-item-vote-info " data-votecount="103"><span class="voters"><span class="user-block"><a data-tip="p$t$yang-jian-xin-51" href="http://www.zhihu.com/people/yang-jian-xin-51" class="zg-link" title="杨建新">杨建新</a>、</span><span class="user-block"><a data-tip="p$t$ijesonchen" href="http://www.zhihu.com/people/ijesonchen" class="zg-link" title="Jeson Chen">Jeson Chen</a>、</span><span class="user-block"><a data-tip="p$t$uaZ_" href="http://www.zhihu.com/people/uaZ_" class="zg-link" title="uazw">uazw</a></span></span><a href="javascript:;" class="more"> 等人赞同</a></div></div><div class="zm-item-rich-text js-collapse-body" data-resourceid="4727522" data-action="/answer/content" data-author-name="刘然" data-entry-url="/question/31325454/answer/51920170"><textarea class="content hidden">不是很同意 &lt;a data-hash=&quot;b07cd4743bee223e37bad07299114cfc&quot; href=&quot;//www.zhihu.com/people/b07cd4743bee223e37bad07299114cfc&quot; class=&quot;member_mention&quot; data-editable=&quot;true&quot; data-title=&quot;@北极&quot; data-tip=&quot;p$b$b07cd4743bee223e37bad07299114cfc&quot;&gt;@北极&lt;/a&gt; 的答案，这个要分情况进行讨论，其实大多数时候并不需要加锁。&lt;br&gt;&lt;br&gt;&lt;b&gt;第一种情况：&lt;/b&gt;&lt;br&gt;读线程不会干扰写线程，换句话说，写变量的线程下面的操作不依赖于读线程已经看到自己所写的值时：&lt;b&gt;&lt;u&gt;不需要加锁&lt;/u&gt;，多核体系好比分布式系统，只有事件发生的因果顺序才是重要的，绝对时间并不重要&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;第二种情况：&lt;/b&gt;&lt;br&gt;逻辑上允许读线程读到旧的值，此时&lt;b&gt;&lt;u&gt;不需要加锁&lt;/u&gt;&lt;/b&gt;，这也是RCU的主要应用场景&lt;br&gt;&lt;br&gt;&lt;b&gt;第三种情况：&lt;/b&gt;&lt;br&gt;写线程写的数据处于同一条cache line内部，且可以原子的一条指令写完，此时&lt;b&gt;&lt;u&gt;不需要加锁&lt;/u&gt;，需要在读写两侧加上合适的Memory Barrier,在x86上是lock前缀指令和fence指令等&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;第四种情况：&lt;/b&gt;&lt;br&gt;&lt;b&gt;&lt;u&gt;请加读写锁。&lt;/u&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;----&lt;/b&gt;&lt;br&gt;当然，如果你对性能要求十分苛刻，一个周期也不想浪费，可以试一下我提出的被动读写锁&lt;br&gt;&lt;b&gt;参见我的论文：&lt;/b&gt;&lt;b&gt;Scalable Read-mostly Synchronization UsingPassive Reader-Writer Locks&lt;/b&gt;&lt;br&gt;&lt;b&gt;&lt;a href=&quot;https://www.usenix.org/system/files/conference/atc14/atc14-paper-liu.pdf&quot; class=&quot; external&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;span class=&quot;invisible&quot;&gt;https://www.&lt;/span&gt;&lt;span class=&quot;visible&quot;&gt;usenix.org/system/files&lt;/span&gt;&lt;span class=&quot;invisible&quot;&gt;/conference/atc14/atc14-paper-liu.pdf&lt;/span&gt;&lt;span class=&quot;ellipsis&quot;&gt;&lt;/span&gt;&lt;i class=&quot;icon-external&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/b&gt;<span class="answer-date-link-wrap"><a class="answer-date-link meta-item" target="_blank" href="/question/31325454/answer/51920170">发布于 2015-06-19</a></span></textarea><div class="zh-summary summary clearfix">不是很同意 <a data-hash="b07cd4743bee223e37bad07299114cfc" href="//www.zhihu.com/people/b07cd4743bee223e37bad07299114cfc" class="member_mention" data-editable="true" data-title="@北极" data-tip="p$b$b07cd4743bee223e37bad07299114cfc">@北极</a> 的答案，这个要分情况进行讨论，其实大多数时候并不需要加锁。<b>第一种情况：</b>读线程不会干扰写线程，换句话说，写变量的线程下面的操作不依赖于读线程已经看到自己所写的值时：<b><u>不需要加锁</u>，多核体系好比分布式系统，只有事件发生的因果顺序…</b><a href="/question/31325454/answer/51920170" class="toggle-expand">显示全部</a></div></div><div class="zm-item-meta zm-item-comment-el answer-actions clearfix"><div class="zm-meta-panel"><a data-follow="q:link" class="follow-link zg-follow meta-item" href="javascript:;" id="sfb-4727522"><i class="z-icon-follow"></i>关注问题</a><a href="#" name="addcomment" class=" meta-item toggle-comment"><i class="z-icon-comment"></i>19 条评论</a><a href="#" class="meta-item zu-autohide" name="thanks" data-thanked="false"><i class="z-icon-thank"></i>感谢</a><a href="#" class="meta-item zu-autohide" name="share"><i class="z-icon-share"></i>分享</a><a href="#" class="meta-item zu-autohide" name="favo"><i class="z-icon-collect"></i>收藏</a><span class="zg-bull zu-autohide">&bull;</span><a href="#" name="nohelp" class="meta-item zu-autohide">没有帮助</a><span class="zg-bull zu-autohide">&bull;</span><a href="#" name="report" class="meta-item zu-autohide">举报</a><span class="zg-bull">&bull;</span><a href="/terms#sec-licence-1" target="_blank" class="meta-item copyright"> 作者保留权利 </a><button class="meta-item item-collapse js-collapse"><i class="z-icon-fold"></i>收起</button></div></div></div></div><div class="zm-item" id="mi-1413975031"><h2><a class="question_link" href="/question/26154747/answer/32283502">有 Memory Segmentation 和 Paging 等技术时，C/C++，Pascal 等低级语言中对内存布局的控制意义何在？</a></h2><div tabindex="-1" class="zm-item-answer "data-aid="8299218"data-atoken="32283502"data-collapsed="0"data-created="1413975031"data-deleted="0"data-isowner="0"data-helpful="1"data-copyable="1"><a class="zg-anchor-hidden" name="answer-8299218"></a><div class="zm-item-vote"><a class="zm-item-vote-count js-expand js-vote-count" href="javascript:;" data-votecount="48">48</a></div><div class="zm-votebar"><button class="up "><i class="icon vote-arrow"></i><span class="count">48</span><span class="label sr-only">赞同</span></button><button class="down "><i class="icon vote-arrow"></i><span class="label sr-only">反对</span></button></div><div class="answer-head"><div class="zm-item-answer-author-info"><a class="zm-item-link-avatar avatar-link" href="/people/liu-ran-67-90" data-tip="p$t$liu-ran-67-90"><img src="https://pic1.zhimg.com/b53c5a354_s.jpg" class="zm-list-avatar avatar"></a><a class="author-link" data-tip="p$t$liu-ran-67-90" href="/people/liu-ran-67-90">刘然</a>，<span title="Kernel Hacker" class="bio">Kernel Hacker</span></div><div class="zm-item-vote-info " data-votecount="48"><span class="voters"><span class="user-block"><a data-tip="p$t$mu-zi-given" href="http://www.zhihu.com/people/mu-zi-given" class="zg-link" title="木子GivEn">木子GivEn</a>、</span><span class="user-block"><a data-tip="p$t$zqb-laobo" href="http://www.zhihu.com/people/zqb-laobo" class="zg-link" title="zqb laobo">zqb laobo</a>、</span><span class="user-block"><a data-tip="p$t$decray-zeng" href="http://www.zhihu.com/people/decray-zeng" class="zg-link" title="decray zeng">decray zeng</a></span></span><a href="javascript:;" class="more"> 等人赞同</a></div></div><div class="zm-item-rich-text js-collapse-body" data-resourceid="2644765" data-action="/answer/content" data-author-name="刘然" data-entry-url="/question/26154747/answer/32283502"><textarea class="content hidden">啊喂，这些都是高级语言好不好。。。现在的年轻人啊，用着C语言这么高级的语言，还嫌控制内存布局没用？&lt;br&gt;&lt;br&gt;我猜你一定没写过8086实模式汇编吧。。。&lt;br&gt;&lt;br&gt;在远古的洪荒时代，内存都是全局可见的，人们为了访问多一点点内存，小心翼翼地操作着段寄存器。。。&lt;br&gt;&lt;br&gt;少年们啊，珍惜来之不易的虚拟内存抽象吧。在你们内存回收都自动，调一个mmap就觉得自己底层得不得了的今天，可曾想过为了这一天努力过的千万前辈啊！&lt;br&gt;&lt;br&gt;我打赌至少一半程序员都不知道我刚才在说什么。<span class="answer-date-link-wrap"><a class="answer-date-link meta-item" target="_blank" href="/question/26154747/answer/32283502">发布于 2014-10-22</a></span></textarea><div class="zh-summary summary clearfix">啊喂，这些都是高级语言好不好。。。现在的年轻人啊，用着C语言这么高级的语言，还嫌控制内存布局没用？我猜你一定没写过8086实模式汇编吧。。。在远古的洪荒时代，内存都是全局可见的，人们为了访问多一点点内存，小心翼翼地操作着段寄存器。。。少年们啊…<a href="/question/26154747/answer/32283502" class="toggle-expand">显示全部</a></div></div><div class="zm-item-meta zm-item-comment-el answer-actions clearfix"><div class="zm-meta-panel"><a data-follow="q:link" class="follow-link zg-follow meta-item" href="javascript:;" id="sfb-2644765"><i class="z-icon-follow"></i>关注问题</a><a href="#" name="addcomment" class=" meta-item toggle-comment"><i class="z-icon-comment"></i>12 条评论</a><a href="#" class="meta-item zu-autohide" name="thanks" data-thanked="false"><i class="z-icon-thank"></i>感谢</a><a href="#" class="meta-item zu-autohide" name="share"><i class="z-icon-share"></i>分享</a><a href="#" class="meta-item zu-autohide" name="favo"><i class="z-icon-collect"></i>收藏</a><span class="zg-bull zu-autohide">&bull;</span><a href="#" name="nohelp" class="meta-item zu-autohide">没有帮助</a><span class="zg-bull zu-autohide">&bull;</span><a href="#" name="report" class="meta-item zu-autohide">举报</a><span class="zg-bull">&bull;</span><a href="/terms#sec-licence-1" target="_blank" class="meta-item copyright"> 作者保留权利 </a><button class="meta-item item-collapse js-collapse"><i class="z-icon-fold"></i>收起</button></div></div></div></div><div class="zm-item" id="mi-1399986912"><h2><a class="question_link" href="/question/22534262/answer/25566488">和 OS X 相比，Windows 有很多缺点吗？</a></h2><div tabindex="-1" class="zm-item-answer "data-aid="5525229"data-atoken="25566488"data-collapsed="0"data-created="1399986912"data-deleted="0"data-isowner="0"data-helpful="1"data-copyable="1"><a class="zg-anchor-hidden" name="answer-5525229"></a><div class="zm-item-vote"><a class="zm-item-vote-count js-expand js-vote-count" href="javascript:;" data-votecount="27">27</a></div><div class="zm-votebar"><button class="up "><i class="icon vote-arrow"></i><span class="count">27</span><span class="label sr-only">赞同</span></button><button class="down "><i class="icon vote-arrow"></i><span class="label sr-only">反对</span></button></div><div class="answer-head"><div class="zm-item-answer-author-info"><a class="zm-item-link-avatar avatar-link" href="/people/liu-ran-67-90" data-tip="p$t$liu-ran-67-90"><img src="https://pic1.zhimg.com/b53c5a354_s.jpg" class="zm-list-avatar avatar"></a><a class="author-link" data-tip="p$t$liu-ran-67-90" href="/people/liu-ran-67-90">刘然</a>，<span title="Kernel Hacker" class="bio">Kernel Hacker</span></div><div class="zm-item-vote-info " data-votecount="27"><span class="voters"><span class="user-block">知乎用户、</span><span class="user-block">知乎用户、</span><span class="user-block"><a data-tip="p$t$bill-tang-6" href="http://www.zhihu.com/people/bill-tang-6" class="zg-link" title="Bill Tang">Bill Tang</a></span></span><a href="javascript:;" class="more"> 等人赞同</a></div></div><div class="zm-item-rich-text js-collapse-body" data-resourceid="1194424" data-action="/answer/content" data-author-name="刘然" data-entry-url="/question/22534262/answer/25566488"><textarea class="content hidden">虽然已经有这么多回答，但我仍然忍不住要说。&lt;br&gt;也许OS X的用户体验做的是好些，但不得不说，从操作系统内核的技术水平来说，水果还和微软有着不止10年的技术差距。不说别的，你在2G内存的电脑上装个最新的OS X试试？&lt;br&gt;&lt;br&gt;所以，我宁愿买一个丑了些的AKG耳机，我也不想用Beats。&lt;br&gt;差不多就是这个意思，有些道理，你给用Beats的人怎么解释也永远没用。<span class="answer-date-link-wrap"><a class="answer-date-link meta-item" target="_blank" href="/question/22534262/answer/25566488">发布于 2014-05-13</a></span></textarea><div class="zh-summary summary clearfix">虽然已经有这么多回答，但我仍然忍不住要说。也许OS X的用户体验做的是好些，但不得不说，从操作系统内核的技术水平来说，水果还和微软有着不止10年的技术差距。不说别的，你在2G内存的电脑上装个最新的OS X试试？所以，我宁愿买一个丑了些的AKG耳机，我也…<a href="/question/22534262/answer/25566488" class="toggle-expand">显示全部</a></div></div><div class="zm-item-meta zm-item-comment-el answer-actions clearfix"><div class="zm-meta-panel"><a data-follow="q:link" class="follow-link zg-follow meta-item" href="javascript:;" id="sfb-1194424"><i class="z-icon-follow"></i>关注问题</a><a href="#" name="addcomment" class=" meta-item toggle-comment"><i class="z-icon-comment"></i>20 条评论</a><a href="#" class="meta-item zu-autohide" name="thanks" data-thanked="false"><i class="z-icon-thank"></i>感谢</a><a href="#" class="meta-item zu-autohide" name="share"><i class="z-icon-share"></i>分享</a><a href="#" class="meta-item zu-autohide" name="favo"><i class="z-icon-collect"></i>收藏</a><span class="zg-bull zu-autohide">&bull;</span><a href="#" name="nohelp" class="meta-item zu-autohide">没有帮助</a><span class="zg-bull zu-autohide">&bull;</span><a href="#" name="report" class="meta-item zu-autohide">举报</a><span class="zg-bull">&bull;</span><a href="/terms#sec-licence-1" target="_blank" class="meta-item copyright"> 作者保留权利 </a><button class="meta-item item-collapse js-collapse"><i class="z-icon-fold"></i>收起</button></div></div></div></div></div></div></div></div></div></div></div><div class="zu-main-sidebar"><div class="zm-side-section"><div class="zm-side-section-inner"><div class="well login-reg-box"><span>知乎是一个真实的问答社区，在这里分享知识、经验和见解，发现更大的世界。<br><a id="js-reg-with-mail-in-top" href="#">使用手机或邮箱注册</a><!-- <span>·</span><a id="js-reg-with-qq-in-top" href="#">使用 QQ 登录</a> --></span><div class="clearfix"><a id="js-reg-with-wechat-in-top" href="#" class="zg-btn-green"><span class="z-ico-wechat-right-panel"></span>使用微信登录</a><a id="js-reg-with-sina-in-top" href="#" class="zg-btn-red"><span class="icon-big-white-sina"></span>使用微博登录</a><a id="js-reg-with-qq-in-top" href="#" class="zg-btn-blue"><span class="icon-big-white-qq"></span>使用 QQ 登录</a></div></div></div></div><div class="zm-profile-side-following zg-clear"><a class="item" href="/people/liu-ran-67-90/followees"><span class="zg-gray-normal">关注了</span><br /><strong>128</strong><label> 人</label></a><a class="item" href="/people/liu-ran-67-90/followers"><span class="zg-gray-normal">关注者</span><br /><strong>6627</strong><label> 人</label></a></div><div class="zm-profile-side-section"><div class="zm-side-section-inner zg-clear"><div class="zm-profile-side-section-title">关注了 <a href="/people/liu-ran-67-90/columns/followed" class="zg-link-litblue"><strong>8 个专栏</strong></a></div><div class="zm-profile-side-columns"><a href="http://zhuanlan.zhihu.com/graphics" data-tip="c$t$graphics" class="link" target="_blank"><img class="avatar avatar-is" alt="Behind the Pixels" src="https://pic1.zhimg.com/cc87cf6df6c569f155d60f4b34957ffc_l.jpg" srcset="https://pic1.zhimg.com/cc87cf6df6c569f155d60f4b34957ffc_l.jpg 2x" /></a><a href="http://zhuanlan.zhihu.com/musicrelated" data-tip="c$t$musicrelated" class="link" target="_blank"><img class="avatar avatar-is" alt="Music Related" src="https://pic2.zhimg.com/6b2d0bce5_l.jpg" srcset="https://pic2.zhimg.com/6b2d0bce5_l.jpg 2x" /></a><a href="http://zhuanlan.zhihu.com/nospoon" data-tip="c$t$nospoon" class="link" target="_blank"><img class="avatar avatar-is" alt="酸辣鸡汤就不给勺" src="https://pic4.zhimg.com/57a14524277d070122bd1e4afb5c399f_l.jpg" srcset="https://pic4.zhimg.com/57a14524277d070122bd1e4afb5c399f_l.jpg 2x" /></a><a href="http://zhuanlan.zhihu.com/ChefElyn" data-tip="c$t$ChefElyn" class="link" target="_blank"><img class="avatar avatar-is" alt="餐桌、橱柜和厨房" src="https://pic2.zhimg.com/b38440fa9_l.jpg" srcset="https://pic2.zhimg.com/b38440fa9_l.jpg 2x" /></a><a href="http://zhuanlan.zhihu.com/chenqin" data-tip="c$t$chenqin" class="link" target="_blank"><img class="avatar avatar-is" alt="Clean Data" src="https://pic4.zhimg.com/4b70deef7_l.jpg" srcset="https://pic4.zhimg.com/4b70deef7_l.jpg 2x" /></a><a href="http://zhuanlan.zhihu.com/computers" data-tip="c$t$computers" class="link" target="_blank"><img class="avatar avatar-is" alt="About Computers" src="https://pic4.zhimg.com/008a19032e74677b9dcc1946e520b63f_l.png" srcset="https://pic4.zhimg.com/008a19032e74677b9dcc1946e520b63f_l.png 2x" /></a><a href="http://zhuanlan.zhihu.com/sulian" data-tip="c$t$sulian" class="link" target="_blank"><img class="avatar avatar-is" alt="私宅" src="https://pic3.zhimg.com/abfa7bee2_l.jpg" srcset="https://pic3.zhimg.com/abfa7bee2_l.jpg 2x" /></a></div></div></div><div class="zm-profile-side-section"><div class="zm-side-section-inner zg-clear"><div class="zm-profile-side-section-title">关注了 <a href="/people/liu-ran-67-90/topics" class="zg-link-litblue"><strong>12 个话题</strong></a></div><div class="zm-profile-side-topics" id="zh-profile-following-topic"><a class="link" data-tip="t$t$19551557" href="/topic/19551557"><img class="avatar" src="https://pic1.zhimg.com/e8b840284350f4a2d01ea6869926bfcc_m.jpg" title="设计"></a><a class="link" data-tip="t$t$19568349" href="/topic/19568349"><img class="avatar" src="https://pic1.zhimg.com/e6dafdb34_m.jpg" title="人文"></a><a class="link" data-tip="t$t$19550517" href="/topic/19550517"><img class="avatar" src="https://pic4.zhimg.com/f07808da5625fef3607f8b75b770349f_m.jpg" title="互联网"></a><a class="link" data-tip="t$t$19550573" href="/topic/19550573"><img class="avatar" src="https://pic3.zhimg.com/8c683a8ff838d47297b6b28f6998ea06_m.png" title="Adobe Photoshop"></a><a class="link" data-tip="t$t$19550453" href="/topic/19550453"><img class="avatar" src="https://pic2.zhimg.com/77bb73569321c6a9fdcb75cab81cf36d_m.jpg" title="音乐"></a><a class="link" data-tip="t$t$19550994" href="/topic/19550994"><img class="avatar" src="https://pic4.zhimg.com/fb89e0ea3_m.jpg" title="游戏"></a><a class="link" data-tip="t$t$19556664" href="/topic/19556664"><img class="avatar" src="https://pic3.zhimg.com/6d7dc1d82127396331a952e93fda484e_m.jpg" title="科技"></a></div></div></div><div class="zm-profile-side-section"><div class="zm-side-section-inner"><span class="zg-gray-normal">个人主页被 <strong>1893</strong> 人浏览</span></div></div><script type="text/json" class="json-inline" data-name="current_people">["\u5218\u7136","liu-ran-67-90","https:\/\/pic1.zhimg.com\/b53c5a354_s.jpg","04fbfba44a869601cfcefa3013c8fcfa"]</script><div id="zh-footer" class="zh-footer"><div class="content zg-wrap clearfix"><ul><li><a href="https://liukanshan.zhihu.com" target="_blank">刘看山</a></li><li><a href="/app" target="_blank">移动应用</a></li><li><a href="/careers">加入知乎</a></li><li><a href="/terms" target="_blank">知乎协议</a></li><li><a href="mailto:bd@zhihu.com">商务合作</a></li></ul><span class="copy">&copy; 2015 知乎</span></div></div></div></div><script type="text/json" class="json-inline" data-name="guiders2">{}</script><script type="text/json" class="json-inline" data-name="current_user">["","","","-1","",0,0]</script><script type="text/json" class="json-inline" data-name="env">["zhihu.com","comet.zhihu.com",false,null]</script><script type="text/json" class="json-inline" data-name="permissions">[]</script><script type="text/json" class="json-inline" data-name="ga_vars">{"user_created":0,"now":1449138633000,"abtest_mask":"------------------------------","user_attr":[0,0,0,"-","-"],"user_hash":0}</script><script src="http://static.zhihu.com/static/revved/-/js/vendor.1a51eb6e.js"></script><script src="http://static.zhihu.com/static/revved/-/js/closure/common.d3bfcd50.js"></script><script src="http://static.zhihu.com/static/revved/-/js/closure/richtexteditor.4bc37c3f.js" async></script><script src="http://static.zhihu.com/static/revved/-/js/closure/page-profile.356b6d36.js"></script><meta name="entry" content="ZH.entryProfile" data-module-id="page-profile"><script type="text/zscript" znonce="07e06b85c1c8417abb4203024c9819b1"></script><input type="hidden" name="_xsrf" value="a7bdc3ebe3d7293a24d26263e1b4a7f6"/></body></html>