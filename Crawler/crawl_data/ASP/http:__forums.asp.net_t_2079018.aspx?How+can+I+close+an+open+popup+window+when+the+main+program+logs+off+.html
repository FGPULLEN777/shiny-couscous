<!DOCTYPE HTML><html><head>	<title>How can I close an open popup window when the main program logs off? | The ASP.NET Forums</title>	<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />            <meta name="viewport" content="width=device-width, initial-scale=1"/>    	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>    <link rel="alternate" type="application/rss+xml" title="How can I close an open popup window when the main program logs off? RSS" href="/t/rss/2079018" />    <meta name="description" content="I'm using Visual Web Developer 2010 Express with SQL Server 2008 Express, VB. I have a popup window that may or may not be open (depending the user choice). If the window is open I would like to be..." /><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@aspnet" /><meta name="twitter:domain" content="forums.asp.net" /><meta name="twitter:image:src" content="//forums-asp.azureedge.net/resources/v-2015-12-04-001/cheetah/images/ui/asplogo-square.png" /><meta name="twitter:title" content="How can I close an open popup window when the main program logs off..." /><meta name="twitter:description" content="I'm using Visual Web Developer 2010 Express with SQL Server 2008 Express, VB. I have a popup window that may or may not be open (depending the user choice). If the window is open I would like to be..." /><meta property="og:type" content="website" /><meta property="og:title" content="How can I close an open popup window when the main program logs off..." /><meta property="og:description" content="I'm using Visual Web Developer 2010 Express with SQL Server 2008 Express, VB. I have a popup window that may or may not be open (depending the user choice). If the window is open I would like to be..." /><meta property="og:image" content="//forums-asp.azureedge.net/resources/v-2015-12-04-001/cheetah/images/ui/asplogo-square.png" /><meta property="og:url" content="http://forums.asp.net/t/2079018.aspx?How+can+I+close+an+open+popup+window+when+the+main+program+logs+off+" /><meta property="og:site_name" content="The Official Forums for Microsoft ASP.NET" /><meta property="fb:admins" content="scott.hanselman" /><meta property="fb:admins" content="jon.galloway" /><meta property="fb:admins" content="robmcm" />    <link rel="canonical" href="http://forums.asp.net/t/2079018.aspx?How+can+I+close+an+open+popup+window+when+the+main+program+logs+off+" />    <link rel="search" type="application/opensearchdescription+xml" title="Forums.asp.net" href="/opensearch.xml">	<link href="//forums-asp.azureedge.net/resources/v-2015-12-04-001/favicon.ico" rel="shortcut icon" />        			<link href="//forums-asp.azureedge.net/resources/v-2015-12-04-001/cheetah/style/css-bundle/common-responsive.css" rel="stylesheet" type="text/css" media="all" />	    				<!--[if lte IE 9]>      <script src='//forums-asp.azureedge.net/resources/v-2015-12-04-001/scripts/html5.js' type="text/javascript"></script>    <![endif]-->    <script type="text/javascript" src="//forums-asp.azureedge.net/resources/v-2015-12-04-001/scripts/jquery-1.8.3.min.js"></script>	<script type="text/javascript">$.ajaxSetup({ cache: false }); var isProd = true;</script>	    	<style id="antiClickjack">body{display:none !important;}</style>	<script type="text/javascript">if(self===top){var antiClickjack=document.getElementById("antiClickjack");antiClickjack.parentNode.removeChild(antiClickjack)}else top.location=self.location;</script>		<script type="text/javascript">		var appInsights=window.appInsights||function(config){			function r(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},u=document,e=window,o="script",s=u.createElement(o),i,f;for(s.src=config.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",u.getElementsByTagName(o)[0].parentNode.appendChild(s),t.cookie=u.cookie,t.queue=[],i=["Event","Exception","Metric","PageView","Trace"];i.length;)r("track"+i.pop());return r("setAuthenticatedUserContext"),r("clearAuthenticatedUserContext"),config.disableExceptionTracking||(i="onerror",r("_"+i),f=e[i],e[i]=function(config,r,u,e,o){var s=f&&f(config,r,u,e,o);return s!==!0&&t["_"+i](config,r,u,e,o),s}),t		}({			samplingPercentage: 10, 			instrumentationKey:"e363b0f3-90f9-4e21-bd67-4cb4346b1218"	    });       		window.appInsights=appInsights;		appInsights.trackPageView();    </script></head><body class="details">		    <div class="all-content">	    <!--<div style="background-color:#fc0;padding:10px;font-size:16px;text-align:center;">Edit me from backoffice - Raw > Banner</div>-->		<header>			<div class="header-content">				<a href="//www.asp.net/" id="logo" data-s-object-id="logo"><svg version="1.1" id="svg5358" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1033.746 220.695" enable-background="new 0 0 1033.746 220.695" xml:space="preserve"><path id="path5056" fill="#FFFFFF" d="M1033.745,99.838v-18.18h-22.576V53.395l-0.76,0.234l-21.205,6.487l-0.417,0.128v21.414h-33.469V69.73c0-5.556,1.242-9.807,3.689-12.643c2.432-2.801,5.909-4.225,10.343-4.225c3.188,0,6.49,0.752,9.812,2.232l0.832,0.371V36.32l-0.391-0.143c-3.1-1.114-7.315-1.676-12.539-1.676c-6.585,0-12.568,1.433-17.786,4.273c-5.222,2.844-9.329,6.903-12.205,12.065c-2.868,5.156-4.322,11.111-4.322,17.702v13.115H917.03v18.18h15.721v76.59h22.567v-76.59h33.469v48.672c0,20.045,9.455,30.203,28.101,30.203c3.065,0,6.289-0.359,9.583-1.063c3.352-0.722,5.634-1.443,6.978-2.213l0.298-0.176v-18.348l-0.918,0.607c-1.225,0.816-2.75,1.483-4.539,1.979c-1.796,0.505-3.296,0.758-4.457,0.758c-4.369,0-7.6-1.177-9.606-3.5c-2.027-2.344-3.057-6.443-3.057-12.177V99.838H1033.745L1033.745,99.838z M866.634,160.26c-8.191,0-14.648-2.716-19.2-8.066c-4.578-5.377-6.898-13.043-6.898-22.783c0-10.049,2.32-17.914,6.901-23.387c4.554-5.436,10.95-8.194,19.014-8.194c7.825,0,14.054,2.635,18.515,7.836c4.485,5.228,6.76,13.03,6.76,23.196c0,10.291-2.14,18.196-6.359,23.484C881.175,157.594,874.874,160.26,866.634,160.26 M867.639,79.375c-15.627,0-28.04,4.579-36.889,13.61c-8.844,9.032-13.329,21.531-13.329,37.153c0,14.838,4.378,26.773,13.012,35.468c8.634,8.698,20.384,13.104,34.92,13.104c15.148,0,27.313-4.643,36.16-13.799c8.845-9.146,13.326-21.527,13.326-36.784c0-15.07-4.205-27.094-12.503-35.731C894.035,83.756,882.358,79.375,867.639,79.375 M781.035,79.375c-10.63,0-19.422,2.719-26.14,8.08c-6.758,5.393-10.185,12.466-10.185,21.025c0,4.448,0.739,8.4,2.195,11.752c1.466,3.363,3.733,6.324,6.744,8.809c2.99,2.465,7.603,5.047,13.718,7.674c5.139,2.115,8.973,3.904,11.407,5.314c2.38,1.382,4.07,2.771,5.023,4.124c0.927,1.323,1.398,3.136,1.398,5.372c0,6.367-4.768,9.465-14.579,9.465c-3.639,0-7.79-0.76-12.338-2.258c-4.55-1.496-8.801-3.647-12.634-6.406l-0.936-0.672v21.727l0.344,0.16c3.193,1.474,7.219,2.717,11.963,3.695c4.736,0.979,9.039,1.477,12.778,1.477c11.534,0,20.823-2.732,27.601-8.125c6.821-5.43,10.279-12.67,10.279-21.525c0-6.388-1.861-11.867-5.53-16.284c-3.643-4.382-9.965-8.405-18.785-11.961c-7.026-2.82-11.527-5.161-13.384-6.958c-1.79-1.736-2.698-4.191-2.698-7.3c0-2.756,1.121-4.964,3.425-6.753c2.321-1.797,5.551-2.711,9.604-2.711c3.76,0,7.607,0.594,11.433,1.758c3.824,1.164,7.182,2.723,9.985,4.63l0.921,0.63V83.504l-0.354-0.152c-2.587-1.109-5.996-2.059-10.138-2.828C788.029,79.761,784.288,79.375,781.035,79.375 M685.878,160.26c-8.188,0-14.648-2.716-19.198-8.066c-4.58-5.377-6.896-13.041-6.896-22.783c0-10.049,2.318-17.914,6.901-23.387c4.55-5.436,10.944-8.194,19.013-8.194c7.822,0,14.051,2.635,18.514,7.836c4.484,5.228,6.76,13.03,6.76,23.196c0,10.291-2.142,18.196-6.361,23.484C700.419,157.594,694.12,160.26,685.878,160.26 M686.886,79.375c-15.632,0-28.044,4.579-36.889,13.61c-8.844,9.032-13.331,21.531-13.331,37.153c0,14.844,4.38,26.773,13.014,35.468c8.634,8.698,20.382,13.104,34.92,13.104c15.145,0,27.313-4.643,36.16-13.799c8.842-9.146,13.326-21.527,13.326-36.784c0-15.07-4.207-27.094-12.506-35.731C713.276,83.756,701.604,79.375,686.886,79.375 M602.409,98.07V81.658h-22.293v94.767h22.293v-48.477c0-8.243,1.868-15.015,5.556-20.13c3.642-5.054,8.494-7.615,14.418-7.615c2.007,0,4.261,0.332,6.702,0.986c2.416,0.651,4.166,1.357,5.199,2.102l0.936,0.679V81.496l-0.361-0.155c-2.076-0.882-5.012-1.327-8.729-1.327c-5.602,0-10.615,1.8-14.908,5.344c-3.77,3.115-6.494,7.387-8.577,12.713H602.409L602.409,98.07z M540.195,79.375c-10.226,0-19.349,2.193-27.108,6.516c-7.775,4.333-13.787,10.52-17.879,18.385c-4.072,7.848-6.14,17.014-6.14,27.235c0,8.954,2.005,17.171,5.967,24.413c3.966,7.254,9.578,12.928,16.682,16.865c7.094,3.931,15.293,5.924,24.37,5.924c10.594,0,19.639-2.118,26.892-6.295l0.292-0.168v-20.423l-0.937,0.684c-3.285,2.393-6.956,4.303-10.906,5.679c-3.939,1.375-7.532,2.07-10.681,2.07c-8.748,0-15.769-2.737-20.866-8.133c-5.109-5.403-7.699-12.99-7.699-22.537c0-9.607,2.701-17.389,8.025-23.131c5.306-5.726,12.341-8.629,20.907-8.629c7.327,0,14.468,2.48,21.223,7.381l0.934,0.679V84.371l-0.302-0.17c-2.542-1.423-6.008-2.598-10.313-3.488C548.37,79.824,544.18,79.375,540.195,79.375 M473.715,81.658h-22.293v94.767h22.293V81.658z M462.796,41.287c-3.668,0-6.868,1.249-9.497,3.725c-2.64,2.482-3.98,5.607-3.98,9.295c0,3.629,1.324,6.697,3.938,9.113c2.598,2.408,5.808,3.63,9.54,3.63c3.731,0,6.954-1.222,9.583-3.626c2.646-2.42,3.987-5.488,3.987-9.117c0-3.559-1.305-6.652-3.879-9.195C469.918,42.574,466.656,41.287,462.796,41.287 M407.177,74.667v101.757h22.75V44.189H398.44l-40.022,98.221l-38.839-98.221h-32.769v132.234h21.379V74.657h0.734l41.013,101.767h16.134l40.372-101.757H407.177L407.177,74.667z"/><path id="path5058" fill="#F1511B" d="M104.867,104.867H0V0h104.867V104.867z"/><path id="path5060" fill="#80CC28" d="M220.654,104.867H115.787V0h104.867V104.867z"/><path id="path5062" fill="#00ADEF" d="M104.865,220.695H0V115.828h104.865V220.695z"/><path id="path5064" fill="#FBBC09" d="M220.654,220.695H115.787V115.828h104.867V220.695z"/></svg></a>				<a href="https://jabbr.net/#/rooms/Lobby" class="jabbr" title="JabbR"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 13.327 14.89" enable-background="new 0 0 13.327 14.89" xml:space="preserve"><g opacity="0.9"><g><defs><rect id="SVGID_1_" width="13.327" height="14.89"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" overflow="visible"/></clipPath><path clip-path="url(#SVGID_2_)" fill="#FFFFFF" d="M11.422,11.915c-0.098-0.154-0.207-0.312-0.327-0.474c-0.119-0.162-0.244-0.313-0.375-0.454c-0.132-0.14-0.267-0.263-0.408-0.367c-0.141-0.106-0.285-0.183-0.436-0.229v-0.028c0.342-0.099,0.652-0.234,0.932-0.408c0.278-0.172,0.517-0.379,0.713-0.617c0.197-0.239,0.35-0.508,0.457-0.805c0.107-0.298,0.162-0.623,0.162-0.974c0-1.324-0.651-2.161-1.935-2.525c0.001-0.038,0.009-0.074,0.009-0.112c0-2.344-1.59-4.319-3.747-4.917v0.679c1.785,0.575,3.081,2.246,3.091,4.216C9.224,4.851,8.871,4.817,8.472,4.817h-0.27C8.154,3.352,7.089,2.142,5.688,1.875v0.673c1.037,0.254,1.813,1.166,1.86,2.269H6.565C6.512,4.055,5.882,3.452,5.106,3.452c-0.811,0-1.468,0.657-1.468,1.468c0,0.732,0.535,1.333,1.234,1.446v8.529h2.27v-3.857h0.612c0.14,0,0.271,0.028,0.39,0.088c0.119,0.058,0.234,0.142,0.345,0.252s0.219,0.242,0.327,0.397c0.106,0.154,0.22,0.33,0.336,0.527l1.568,2.593h2.606L11.422,11.915z M9.3,8.9C9.005,9.181,8.614,9.323,8.126,9.323H7.143V6.517h1.026c1.056,0,1.582,0.441,1.582,1.322C9.75,8.26,9.601,8.614,9.3,8.9"/><path clip-path="url(#SVGID_2_)" fill="#FFFFFF" d="M0.654,4.92c0-1.979,1.301-3.661,3.092-4.238V0.003C1.59,0.602,0,2.577,0,4.92C0,7.265,1.59,9.24,3.746,9.838v-0.68C1.955,8.582,0.654,6.901,0.654,4.92"/><path clip-path="url(#SVGID_2_)" fill="#FFFFFF" d="M2.656,4.92c0-1.162,0.814-2.132,1.901-2.383V1.872C3.107,2.133,2.002,3.397,2.002,4.92S3.107,7.708,4.558,7.97V7.304C3.47,7.053,2.656,6.083,2.656,4.92"/></g></g></svg></a>				<a href="http://twitter.com/aspnet" class="twitter" title="Twitter"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 15 12.233" enable-background="new 0 0 15 12.233" xml:space="preserve"><path fill="#FFFFFF" d="M15,1.469c-0.287,0.116-0.576,0.21-0.865,0.282c-0.287,0.072-0.59,0.137-0.906,0.194c0.316-0.201,0.59-0.446,0.82-0.735c0.231-0.288,0.418-0.604,0.563-0.951c-0.318,0.145-0.643,0.289-0.973,0.432c-0.332,0.145-0.684,0.246-1.059,0.303c-0.26-0.317-0.576-0.562-0.951-0.735C11.253,0.086,10.835,0,10.375,0C9.539,0,8.819,0.302,8.213,0.908c-0.605,0.605-0.908,1.34-0.908,2.204c0,0.173,0.029,0.404,0.087,0.691C6.095,3.746,4.906,3.43,3.826,2.853c-1.082-0.576-2.011-1.34-2.789-2.291c-0.259,0.49-0.388,1.009-0.388,1.556c0,1.153,0.446,2.004,1.34,2.55c-0.52,0-0.98-0.114-1.384-0.345v0.043c0,0.75,0.23,1.405,0.692,1.966c0.461,0.563,1.037,0.916,1.729,1.06C2.91,7.421,2.787,7.443,2.658,7.457c-0.129,0.014-0.28,0.021-0.454,0.021c-0.115,0-0.288-0.028-0.518-0.086c0.172,0.605,0.518,1.109,1.037,1.512c0.519,0.404,1.124,0.621,1.816,0.648c-1.095,0.865-2.364,1.297-3.804,1.297H0c0.663,0.433,1.398,0.771,2.204,1.017c0.807,0.246,1.643,0.367,2.508,0.367c1.411,0,2.665-0.267,3.761-0.8c1.095-0.532,2.009-1.217,2.743-2.054c0.735-0.835,1.289-1.771,1.666-2.809c0.373-1.039,0.561-2.076,0.561-3.113V3.069c0.316-0.23,0.605-0.482,0.865-0.757C14.568,2.039,14.798,1.758,15,1.469"/></svg></a>				<a href="https://www.facebook.com/asp.net" class="facebook" title="Facebook"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 7.001 15" enable-background="new 0 0 7.001 15" xml:space="preserve"><g opacity="0.9"><g><defs><rect id="SVGID_1_" width="7.001" height="15"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" overflow="visible"/></clipPath><path clip-path="url(#SVGID_2_)" fill="#FFFFFF" d="M6.998,2.633C6.463,2.632,5.926,2.635,5.389,2.632C5.049,2.611,4.699,2.87,4.637,3.207C4.629,3.792,4.635,4.378,4.635,4.964c0.787,0.003,1.574-0.001,2.36,0.002C6.938,5.814,6.832,6.657,6.709,7.499C6.014,7.504,5.318,7.498,4.623,7.501c-0.006,2.5,0.004,5-0.004,7.5c-1.033,0.004-2.066-0.002-3.098,0.004c-0.02-2.5,0.002-5.002-0.011-7.502C1.007,7.498,0.503,7.505,0,7.499C0.001,6.657,0,5.817,0,4.977c0.504-0.006,1.007,0.002,1.51-0.003c0.016-0.817-0.015-1.635,0.017-2.452c0.05-0.646,0.296-1.297,0.78-1.744c0.585-0.557,1.416-0.745,2.2-0.769c0.83-0.007,1.66-0.003,2.49-0.002C7.002,0.881,7.002,1.757,6.998,2.633"/></g></g></svg></a>				<a href="http://blogs.msdn.com/b/webdev/" class="blog">Blog</a>				 <div class="nav-user logged-out">    <a href="javascript:;" class="profile"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 25 25" enable-background="new 0 0 25 25" xml:space="preserve"><path fill="#ffffff" d="M5.163,21.259h1.333c0-3.311,2.694-6.005,6.004-6.005c3.31,0,6.003,2.694,6.003,6.005h1.334c0-3.064-1.891-5.693-4.564-6.79c1.535-0.938,2.564-2.624,2.564-4.55c0-2.942-2.395-5.336-5.337-5.336c-2.943,0-5.337,2.394-5.337,5.336c0,1.926,1.03,3.611,2.564,4.55C7.054,15.565,5.163,18.194,5.163,21.259 M8.498,9.919c0-2.207,1.795-4.002,4.003-4.002c2.206,0,4.001,1.795,4.001,4.002c0,2.206-1.795,4.002-4.001,4.002C10.293,13.921,8.498,12.125,8.498,9.919"/><circle fill="none" stroke="#ffffff" stroke-width="1.483" stroke-miterlimit="10" cx="12.5" cy="12.5" r="10.873"/></svg></a>	<div class="common-dropdown collapse">		<a href="//forums.asp.net/login/RedirectToLogin?ReturnUrl=%2ft%2f2079018.aspx%3fHow%2bcan%2bI%2bclose%2ban%2bopen%2bpopup%2bwindow%2bwhen%2bthe%2bmain%2bprogram%2blogs%2boff%2b">Sign in</a>        <a href="//forums.asp.net/login/RedirectToCreateUser?ReturnUrl=%2ft%2f2079018.aspx%3fHow%2bcan%2bI%2bclose%2ban%2bopen%2bpopup%2bwindow%2bwhen%2bthe%2bmain%2bprogram%2blogs%2boff%2b">Join</a>	</div></div>				<div class="search-form">					<input name="searchterm" type="text" class="search-input" placeholder="Search" />					<a href="javascript:;" class="search-submit"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 18 18" enable-background="new 0 0 18 18" xml:space="preserve"><path fill="#FFFFFF" d="M5.89,11.594c1.32,0,2.532-0.461,3.49-1.229l7.267,7.268c0.122,0.119,0.28,0.182,0.439,0.182s0.319-0.063,0.44-0.182c0.242-0.244,0.242-0.639,0-0.881L10.26,9.486c0.767-0.958,1.229-2.17,1.229-3.49c0-3.087-2.511-5.598-5.599-5.598c-3.087,0-5.598,2.511-5.598,5.598S2.803,11.594,5.89,11.594 M5.89,1.642c2.401,0,4.354,1.953,4.354,4.354S8.291,10.35,5.89,10.35c-2.4,0-4.354-1.953-4.354-4.354S3.489,1.642,5.89,1.642"/></svg></a>				</div>									</div>        </header>		<nav class="clearfix nav-main">			<div>				<a href="javascript:;" class="icon"></a>				<a href="//www.asp.net/" data-s-object-id="navlogo">ASP.NET</a>								<ul>					<li><a href="//www.asp.net">Home</a></li>										<li><a href="//www.asp.net/get-started">Get Started</a></li>					<li class="nav-learn"><a href="javascript:;">Learn</a><div class="common-dropdown collapse">	<div class="col">	  <h2>Web Applications</h2>	  <ul>		<li><a href="//www.asp.net/web-forms" data-s-object-id="learn">Web Forms</a></li>		<li><a href="//www.asp.net/mvc" data-s-object-id="learn">MVC</a></li>		<li><a href="//www.asp.net/web-pages" data-s-object-id="learn">Web Pages/Razor</a></li>		<li><a href="//www.asp.net/mobile" data-s-object-id="learn">Mobile</a></li>		<li><a href="//www.asp.net/single-page-application" data-s-object-id="learn">Single Page Apps</a></li>	  </ul>	</div>	<div class="col">	  <h2>Web Services / API's</h2>		<ul>		  <li><a href="//www.asp.net/web-api" data-s-object-id="learn">Web API</a></li>		</ul>	</div>	<div class="col">	  <h2>Real Time</h2>		<ul>		  <li><a href="//www.asp.net/signalr" data-s-object-id="learn">SignalR</a></li>		</ul>	</div>	<div class="col">	  <h2>Data Access</h2>		<ul>		  <li><a href="//www.asp.net/entity-framework" data-s-object-id="learn">Entity Framework</a></li>		</ul>	</div>	<div class="col">	  <h2>More</h2>		<ul>                         <li><a href="http://blogs.msdn.com/b/webdev/archive/2015/07/20/announcing-asp-net-4-6-and-asp-net-5-beta-5-in-visual-studio-2015-release.aspx" data-s-object-id="learn">Latest Release (2013.5)</a></li>                         <li><a href="//www.asp.net/aspnet" data-s-object-id="learn">Common ASP.NET Features</a></li>                         <li><a href="//www.asp.net/identity" data-s-object-id="learn">Security / Identity</a></li>                         <li><a href="//www.asp.net/visual-studio" data-s-object-id="learn">Tooling/IDE</a></li>                         <li><a href="//www.asp.net/aspnet/overview/deployment" data-s-object-id="learn">Deployment</a></li>                         <li><a href="//www.asp.net/vnext" data-s-object-id="learn">ASP.NET 5 (RC1)</a></li>						 </ul>	</div>  </div></li>					<li><a href="//www.asp.net/hosting">Hosting</a></li>					<li><a href="//www.asp.net/downloads">Downloads</a></li>					<li class="nav-community"><a href="javascript:;">Community</a><div class="common-dropdown collapse">			<div class="col">				<ul>					<li><a href="//www.asp.net/community" data-s-object-id="community">Overview</a></li>					<li><a href="//www.asp.net/community/spotlight" data-s-object-id="community">Community Spotlight</a></li>					<li><a href="//www.asp.net/community/articles" data-s-object-id="community">Articles of the Day</a></li>					<li><a href="//www.asp.net/whats-new" data-s-object-id="community">What's new</a></li>					<li><a href="//weblogs.asp.net/" data-s-object-id="community">Community Blogs</a></li>					<li><a href="//www.asp.net/community/microsoft-blogs" data-s-object-id="community">ASP.NET Team</a></li>					<li><a href="//www.asp.net/community/events" data-s-object-id="community">Events</a></li>				</ul>			</div>			<div class="col">				<ul>					<li><a href="//www.asp.net/community/recognition/hall-of-fame" data-s-object-id="community">Hall Of Fame</a></li>					<li><a href="http://code.msdn.microsoft.com/site/search?f%5B0%5D.Type=Technology&amp;f%5B0%5D.Value=ASP.NET&amp;sortBy=Date" data-s-object-id="community">MSDN Samples</a></li>					<li><a href="//forums.asp.net/" data-s-object-id="community">Forums</a></li>				</ul>			</div>			<div class="col">				<ul>					<li><a href="//www.asp.net/community/websites" data-s-object-id="community">Community Websites</a></li>					<li><a href="//www.asp.net/community/support" data-s-object-id="community">Community Support</a></li>				</ul>			</div>			<div class="col">				<ul>					<li><a href="https://live.asp.net/" data-s-object-id="community">ASP.NET Community Standup</a></li>				</ul>			</div>		</div></li>					<li><a href="//forums.asp.net" class="selected">Forums</a></li>					<li><a href="//www.asp.net/contact-us">Help</a></li>				</ul>			</div>        </nav>        <div class="header-breadcrumb-content">    <a href="//www.asp.net" title="Home">Home</a><span>/</span><a href="//forums.asp.net" title='ASP.NET Forums'>ASP.NET Forums</a><span>/</span><a href="/default.aspx/7?General+ASP+NET" title="General ASP.NET">General ASP.NET</a><span>/</span><a href="/15.aspx/1?Getting+Started" title="Getting Started">Getting Started</a><span>/</span><a href="/t/2079018.aspx?How+can+I+close+an+open+popup+window+when+the+main+program+logs+off+" title="How can I close an open popup window when the main program logs off?">How can I close an open popup window when the main program logs off?</a></div>		<div class="content-wrapper" id="content-wrapper">				<h1 id="threadstatus" class=" indent no-border" title="How can I close an open popup window when the main program logs off?">How can I close an open popup window when the main program logs off?		<a class="icon-rss" href="/t/rss/2079018" title="Feed - How can I close an open popup window when the main program logs off?">RSS</a>		</h1>		<div class="comment-count">			<h2>9 replies        				            			</h2>							<p><a href="/p/2079018/5997216.aspx?Re+How+can+I+close+an+open+popup+window+when+the+main+program+logs+off+">Last post</a> Dec 04, 2015 12:31 AM by <a href="/members/Bulldog248.aspx" title="View Bulldog248's profile">Bulldog248</a></p>									</div>		<div class="pagination-thread first"><a href="/t/prev/2079018" >‹ Previous Thread</a><span class="separator">&#124;</span><a href="/t/next/2079018" >Next Thread ›</a></div>		<div class="clear"></div>		<div class="share">			<a href="javascript:window.print();" class="share-print" title="Print">Print</a>			<a href="javascript:;" class="common-btn share-btn">Share</a>				<div class="share-details" style="display:none;">				<ul>					<li><a href="https://twitter.com/share?url=http%3a%2f%2fforums.asp.net%2ft%2f2079018.aspx%3fHow%2bcan%2bI%2bclose%2ban%2bopen%2bpopup%2bwindow%2bwhen%2bthe%2bmain%2bprogram%2blogs%2boff%2b" class="twitter" title="Twitter"><span></span>Twitter</a></li>					<li><a href="http://www.facebook.com/sharer.php?u=http%3a%2f%2fforums.asp.net%2ft%2f2079018.aspx%3fHow%2bcan%2bI%2bclose%2ban%2bopen%2bpopup%2bwindow%2bwhen%2bthe%2bmain%2bprogram%2blogs%2boff%2b" class="facebook" title="Facebook"><span></span>Facebook</a></li>					<li><a href="mailto:?body=http%3a%2f%2fforums.asp.net%2ft%2f2079018.aspx%3fHow%2bcan%2bI%2bclose%2ban%2bopen%2bpopup%2bwindow%2bwhen%2bthe%2bmain%2bprogram%2blogs%2boff%2b" class="email" title="Email"><span></span>Email</a></li>				</ul>			</div>		</div>		<div class="module-nav-container">	<div class="module-nav nav-base">		<h2>Shortcuts</h2>		<ul>			<li><a href="/f/active/15/1/20">Active Threads</a></li>			<li><a href="/f/unanswered/15/1/20">Unanswered Threads</a></li>			<li><a href="/f/unresolved/15/1/20">Unresolved Threads</a></li>									<li><a href="//www.asp.net/community/support ">Support Options</a></li>			<li><a href="/search">Advanced Search</a></li>		</ul>	</div>	</div>		<ul class="comment-list">			        <li class="comment-wrap thread-starter  " data-postid="5996308" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996308">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="Bulldog248" href="/members/Bulldog248.aspx"><img class="post-thumb" src="/avatar/Bulldog248.jpg?forceidenticon=False&dt=635852169000000000" alt="Bulldog248" title="Bulldog248"/></a><h3 class="post-title"><a title="Bulldog248" href="/members/Bulldog248.aspx">Bulldog248</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="154 Points"></div><p class="post-points">154 Points</p><p class="post-count"><a href="/search?q=authors%3A%28Bulldog248%29&amp;s=postDate&amp;d=desc">241 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996308"></a>              <h3>How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 01, 2015 03:38 PM<span class="print-only-inline"><span class="separator">&#124;</span>Bulldog248</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996308.aspx" title="Permalink to this post">LINK</a></span>        <div><p>I'm using Visual Web Developer 2010 Express with SQL Server 2008 Express, VB.</p><p>I have a popup window that may or may not be open (depending the user choice).&nbsp; If the window is open I would like to be able to automatically close it when the main program logs off through a Logoff button.&nbsp; I would like to be able to do this in the VB code behind.</p><p>Can someone offer a suggestion how I can accomplish this?</p><p>Thanks!</p></div>		                     </div>	    </li>        <li class="comment-wrap   " data-postid="5996345" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996345">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="TechView" href="/members/TechView.aspx"><img class="post-thumb" src="/avatar/TechView.jpg?forceidenticon=False&dt=635852169000000000" alt="TechView" title="TechView"/></a><h3 class="post-title"><a title="TechView" href="/members/TechView.aspx">TechView</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="352 Points"></div><p class="post-points">352 Points</p><p class="post-count"><a href="/search?q=authors%3A%28TechView%29&amp;s=postDate&amp;d=desc">236 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996345"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 01, 2015 05:28 PM<span class="print-only-inline"><span class="separator">&#124;</span>TechView</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996345.aspx" title="Permalink to this post">LINK</a></span>        <div><p>I used a feature that you have written about called Fancy Box. So here it goes:</p><p>Use this css file first: &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;jquery.fancybox.css&quot; media=&quot;screen&quot; /&gt;&nbsp;</p><pre class="prettyprint ">jquery.fancybox.css:/*! fancyBox v2.1.5 fancyapps.com | fancyapps.com/fancybox/#license */.fancybox-wrap,.fancybox-skin,.fancybox-outer,.fancybox-inner,.fancybox-image,.fancybox-wrap iframe,.fancybox-wrap object,.fancybox-nav,.fancybox-nav span,.fancybox-tmp{	padding: 0;	margin: 0;	border: 0;	outline: none;	vertical-align: top;}.fancybox-wrap {	position: absolute;	top: 0;	left: 0;	z-index: 8020;}.fancybox-skin {	position: relative;	background: #f9f9f9;	color: #444;	text-shadow: none;	-webkit-border-radius: 4px;	   -moz-border-radius: 4px;	        border-radius: 4px;}.fancybox-opened {	z-index: 8030;}.fancybox-opened .fancybox-skin {	-webkit-box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);	   -moz-box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);	        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);}.fancybox-outer, .fancybox-inner {	position: relative;}.fancybox-inner {	overflow: hidden;}.fancybox-type-iframe .fancybox-inner {	-webkit-overflow-scrolling: touch;}.fancybox-error {	color: #444;	font: 14px/20px &quot;Helvetica Neue&quot;,Helvetica,Arial,sans-serif;	margin: 0;	padding: 15px;	white-space: nowrap;}.fancybox-image, .fancybox-iframe {	display: block;	width: 100%;	height: 100%;}.fancybox-image {	max-width: 100%;	max-height: 100%;}#fancybox-loading, .fancybox-close, .fancybox-prev span, .fancybox-next span {	background-image: url('fancybox_sprite.png');}#fancybox-loading {	position: fixed;	top: 50%;	left: 50%;	margin-top: -22px;	margin-left: -22px;	background-position: 0 -108px;	opacity: 0.8;	cursor: pointer;	z-index: 8060;}#fancybox-loading div {	width: 44px;	height: 44px;	background: url('fancybox_loading.gif') center center no-repeat;}.fancybox-close {	position: absolute;	top: -18px;	right: -18px;	width: 36px;	height: 36px;	cursor: pointer;	z-index: 8040;}.fancybox-nav {	position: absolute;	top: 0;	width: 40%;	height: 100%;	cursor: pointer;	text-decoration: none;	background: transparent url('blank.gif'); /* helps IE */	-webkit-tap-highlight-color: rgba(0,0,0,0);	z-index: 8040;}.fancybox-prev {	left: 0;}.fancybox-next {	right: 0;}.fancybox-nav span {	position: absolute;	top: 50%;	width: 36px;	height: 34px;	margin-top: -18px;	cursor: pointer;	z-index: 8040;	visibility: hidden;}.fancybox-prev span {	left: 10px;	background-position: 0 -36px;}.fancybox-next span {	right: 10px;	background-position: 0 -72px;}.fancybox-nav:hover span {	visibility: visible;}.fancybox-tmp {	position: absolute;	top: -99999px;	left: -99999px;	visibility: hidden;	max-width: 99999px;	max-height: 99999px;	overflow: visible !important;}/* Overlay helper */.fancybox-lock {    overflow: hidden !important;    width: auto;}.fancybox-lock body {    overflow: hidden !important;}.fancybox-lock-test {    overflow-y: hidden !important;}.fancybox-overlay {	position: absolute;	top: 0;	left: 0;	overflow: hidden;	display: none;	z-index: 8010;	background: url('fancybox_overlay.png');}.fancybox-overlay-fixed {	position: fixed;	bottom: 0;	right: 0;}.fancybox-lock .fancybox-overlay {	overflow: auto;	overflow-y: scroll;}/* Title helper */.fancybox-title {	visibility: hidden;	font: normal 13px/20px &quot;Helvetica Neue&quot;,Helvetica,Arial,sans-serif;	position: relative;	text-shadow: none;	z-index: 8050;}.fancybox-opened .fancybox-title {	visibility: visible;}.fancybox-title-float-wrap {	position: absolute;	bottom: 0;	right: 50%;	margin-bottom: -35px;	z-index: 8050;	text-align: center;}.fancybox-title-float-wrap .child {	display: inline-block;	margin-right: -100%;	padding: 2px 20px;	background: transparent; /* Fallback for web browsers that doesn't support RGBa */	background: rgba(0, 0, 0, 0.8);	-webkit-border-radius: 15px;	   -moz-border-radius: 15px;	        border-radius: 15px;	text-shadow: 0 1px 2px #222;	color: #FFF;	font-weight: bold;	line-height: 24px;	white-space: nowrap;}.fancybox-title-outside-wrap {	position: relative;	margin-top: 10px;	color: #fff;}.fancybox-title-inside-wrap {	padding-top: 10px;}.fancybox-title-over-wrap {	position: absolute;	bottom: 0;	left: 0;	color: #fff;	padding: 10px;	background: #000;	background: rgba(0, 0, 0, .8);}/*Retina graphics!*/@media only screen and (-webkit-min-device-pixel-ratio: 1.5),	   only screen and (min--moz-device-pixel-ratio: 1.5),	   only screen and (min-device-pixel-ratio: 1.5){	#fancybox-loading, .fancybox-close, .fancybox-prev span, .fancybox-next span {		background-image: url('fancybox_sprite@2x.png');		background-size: 44px 152px; /*The size of the normal image, half the size of the hi-res image*/	}	#fancybox-loading div {		background-image: url('fancybox_loading@2x.gif');		background-size: 24px 24px; /*The size of the normal image, half the size of the hi-res image*/	}}</pre><p>And at the end of the footer section, add these two: &nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- Add fancyBox main JS and CSS files --&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;script src=&quot;jquery.fancybox.js&quot;&gt;&lt;/script&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;script src=&quot;Uicreep-custom.js&quot;&gt;&lt;/script&gt;</p><pre class="prettyprint ">jquery.fancybox.js:/*! * fancyBox - jQuery Plugin * version: 2.1.5 (Fri, 14 Jun 2013) * @requires jQuery v1.6 or later * * Examples at http://fancyapps.com/fancybox/ * License: www.fancyapps.com/fancybox/#license * * Copyright 2012 Janis Skarnelis - janis@fancyapps.com * */(function (window, document, &#36;, undefined) {	&quot;use strict&quot;;	var H = &#36;(&quot;html&quot;),		W = &#36;(window),		D = &#36;(document),		F = &#36;.fancybox = function () {			F.open.apply( this, arguments );		},		IE =  navigator.userAgent.match(/msie/i),		didUpdate	= null,		isTouch		= document.createTouch !== undefined,		isQuery	= function(obj) {			return obj &amp;&amp; obj.hasOwnProperty &amp;&amp; obj instanceof &#36;;		},		isString = function(str) {			return str &amp;&amp; &#36;.type(str) === &quot;string&quot;;		},		isPercentage = function(str) {			return isString(str) &amp;&amp; str.indexOf('%') &gt; 0;		},		isScrollable = function(el) {			return (el &amp;&amp; !(el.style.overflow &amp;&amp; el.style.overflow === 'hidden') &amp;&amp; ((el.clientWidth &amp;&amp; el.scrollWidth &gt; el.clientWidth) || (el.clientHeight &amp;&amp; el.scrollHeight &gt; el.clientHeight)));		},		getScalar = function(orig, dim) {			var value = parseInt(orig, 10) || 0;			if (dim &amp;&amp; isPercentage(orig)) {				value = F.getViewport()[ dim ] / 100 * value;			}			return Math.ceil(value);		},		getValue = function(value, dim) {			return getScalar(value, dim) &#43; 'px';		};	&#36;.extend(F, {		// The current version of fancyBox		version: '2.1.5',		defaults: {			padding : 15,			margin  : 20,			width     : 800,			height    : 600,			minWidth  : 100,			minHeight : 100,			maxWidth  : 9999,			maxHeight : 9999,			pixelRatio: 1, // Set to 2 for retina display support			autoSize   : true,			autoHeight : false,			autoWidth  : false,			autoResize  : true,			autoCenter  : !isTouch,			fitToView   : true,			aspectRatio : false,			topRatio    : 0.5,			leftRatio   : 0.5,			scrolling : 'auto', // 'auto', 'yes' or 'no'			wrapCSS   : '',			arrows     : true,			closeBtn   : true,			closeClick : false,			nextClick  : false,			mouseWheel : true,			autoPlay   : false,			playSpeed  : 3000,			preload    : 3,			modal      : false,			loop       : true,			ajax  : {				dataType : 'html',				headers  : { 'X-fancyBox': true }			},			iframe : {				scrolling : 'auto',				preload   : true			},			swf : {				wmode: 'transparent',				allowfullscreen   : 'true',				allowscriptaccess : 'always'			},			keys  : {				next : {					13 : 'left', // enter					34 : 'up',   // page down					39 : 'left', // right arrow					40 : 'up'    // down arrow				},				prev : {					8  : 'right',  // backspace					33 : 'down',   // page up					37 : 'right',  // left arrow					38 : 'down'    // up arrow				},				close  : [27], // escape key				play   : [32], // space - start/stop slideshow				toggle : [70]  // letter &quot;f&quot; - toggle fullscreen			},			direction : {				next : 'left',				prev : 'right'			},			scrollOutside  : true,			// Override some properties			index   : 0,			type    : null,			href    : null,			content : null,			title   : null,			// HTML templates			tpl: {				wrap     : '&lt;div class=&quot;fancybox-wrap&quot; tabIndex=&quot;-1&quot;&gt;&lt;div class=&quot;fancybox-skin&quot;&gt;&lt;div class=&quot;fancybox-outer&quot;&gt;&lt;div class=&quot;fancybox-inner&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;',				image    : '&lt;img class=&quot;fancybox-image&quot; src=&quot;{href}&quot; alt=&quot;&quot; /&gt;',				iframe   : '&lt;iframe id=&quot;fancybox-frame{rnd}&quot; name=&quot;fancybox-frame{rnd}&quot; class=&quot;fancybox-iframe&quot; frameborder=&quot;0&quot; vspace=&quot;0&quot; hspace=&quot;0&quot; webkitAllowFullScreen mozallowfullscreen allowFullScreen' &#43; (IE ? ' allowtransparency=&quot;true&quot;' : '') &#43; '&gt;&lt;/iframe&gt;',				error    : '&lt;p class=&quot;fancybox-error&quot;&gt;The requested content cannot be loaded.&lt;br/&gt;Please try again later.&lt;/p&gt;',				closeBtn : '&lt;a title=&quot;Close&quot; class=&quot;fancybox-item fancybox-close&quot; href=&quot;javascript:;&quot;&gt;&lt;/a&gt;',				next     : '&lt;a title=&quot;Next&quot; class=&quot;fancybox-nav fancybox-next&quot; href=&quot;javascript:;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;',				prev     : '&lt;a title=&quot;Previous&quot; class=&quot;fancybox-nav fancybox-prev&quot; href=&quot;javascript:;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;'			},			// Properties for each animation type			// Opening fancyBox			openEffect  : 'fade', // 'elastic', 'fade' or 'none'			openSpeed   : 250,			openEasing  : 'swing',			openOpacity : true,			openMethod  : 'zoomIn',			// Closing fancyBox			closeEffect  : 'fade', // 'elastic', 'fade' or 'none'			closeSpeed   : 250,			closeEasing  : 'swing',			closeOpacity : true,			closeMethod  : 'zoomOut',			// Changing next gallery item			nextEffect : 'elastic', // 'elastic', 'fade' or 'none'			nextSpeed  : 250,			nextEasing : 'swing',			nextMethod : 'changeIn',			// Changing previous gallery item			prevEffect : 'elastic', // 'elastic', 'fade' or 'none'			prevSpeed  : 250,			prevEasing : 'swing',			prevMethod : 'changeOut',			// Enable default helpers			helpers : {				overlay : true,				title   : true			},			// Callbacks			onCancel     : &#36;.noop, // If canceling			beforeLoad   : &#36;.noop, // Before loading			afterLoad    : &#36;.noop, // After loading			beforeShow   : &#36;.noop, // Before changing in current item			afterShow    : &#36;.noop, // After opening			beforeChange : &#36;.noop, // Before changing gallery item			beforeClose  : &#36;.noop, // Before closing			afterClose   : &#36;.noop  // After closing		},		//Current state		group    : {}, // Selected group		opts     : {}, // Group options		previous : null,  // Previous element		coming   : null,  // Element being loaded		current  : null,  // Currently loaded element		isActive : false, // Is activated		isOpen   : false, // Is currently open		isOpened : false, // Have been fully opened at least once		wrap  : null,		skin  : null,		outer : null,		inner : null,		player : {			timer    : null,			isActive : false		},		// Loaders		ajaxLoad   : null,		imgPreload : null,		// Some collections		transitions : {},		helpers     : {},		/*		 *	Static methods		 */		open: function (group, opts) {			if (!group) {				return;			}			if (!&#36;.isPlainObject(opts)) {				opts = {};			}			// Close if already active			if (false === F.close(true)) {				return;			}			// Normalize group			if (!&#36;.isArray(group)) {				group = isQuery(group) ? &#36;(group).get() : [group];			}			// Recheck if the type of each element is `object` and set content type (image, ajax, etc)			&#36;.each(group, function(i, element) {				var obj = {},					href,					title,					content,					type,					rez,					hrefParts,					selector;				if (&#36;.type(element) === &quot;object&quot;) {					// Check if is DOM element					if (element.nodeType) {						element = &#36;(element);					}					if (isQuery(element)) {						obj = {							href    : element.data('fancybox-href') || element.attr('href'),							title   : element.data('fancybox-title') || element.attr('title'),							isDom   : true,							element : element						};						if (&#36;.metadata) {							&#36;.extend(true, obj, element.metadata());						}					} else {						obj = element;					}				}				href  = opts.href  || obj.href || (isString(element) ? element : null);				title = opts.title !== undefined ? opts.title : obj.title || '';				content = opts.content || obj.content;				type    = content ? 'html' : (opts.type  || obj.type);				if (!type &amp;&amp; obj.isDom) {					type = element.data('fancybox-type');					if (!type) {						rez  = element.prop('class').match(/fancybox\.(\w&#43;)/);						type = rez ? rez[1] : null;					}				}				if (isString(href)) {					// Try to guess the content type					if (!type) {						if (F.isImage(href)) {							type = 'image';						} else if (F.isSWF(href)) {							type = 'swf';						} else if (href.charAt(0) === '#') {							type = 'inline';						} else if (isString(element)) {							type    = 'html';							content = element;						}					}					// Split url into two pieces with source url and content selector, e.g,					// &quot;/mypage.html #my_id&quot; will load &quot;/mypage.html&quot; and display element having id &quot;my_id&quot;					if (type === 'ajax') {						hrefParts = href.split(/\s&#43;/, 2);						href      = hrefParts.shift();						selector  = hrefParts.shift();					}				}				if (!content) {					if (type === 'inline') {						if (href) {							content = &#36;( isString(href) ? href.replace(/.*(?=#[^\s]&#43;&#36;)/, '') : href ); //strip for ie7						} else if (obj.isDom) {							content = element;						}					} else if (type === 'html') {						content = href;					} else if (!type &amp;&amp; !href &amp;&amp; obj.isDom) {						type    = 'inline';						content = element;					}				}				&#36;.extend(obj, {					href     : href,					type     : type,					content  : content,					title    : title,					selector : selector				});				group[ i ] = obj;			});			// Extend the defaults			F.opts = &#36;.extend(true, {}, F.defaults, opts);			// All options are merged recursive except keys			if (opts.keys !== undefined) {				F.opts.keys = opts.keys ? &#36;.extend({}, F.defaults.keys, opts.keys) : false;			}			F.group = group;			return F._start(F.opts.index);		},		// Cancel image loading or abort ajax request		cancel: function () {			var coming = F.coming;			if (!coming || false === F.trigger('onCancel')) {				return;			}			F.hideLoading();			if (F.ajaxLoad) {				F.ajaxLoad.abort();			}			F.ajaxLoad = null;			if (F.imgPreload) {				F.imgPreload.onload = F.imgPreload.onerror = null;			}			if (coming.wrap) {				coming.wrap.stop(true, true).trigger('onReset').remove();			}			F.coming = null;			// If the first item has been canceled, then clear everything			if (!F.current) {				F._afterZoomOut( coming );			}		},		// Start closing animation if is open; remove immediately if opening/closing		close: function (event) {			F.cancel();			if (false === F.trigger('beforeClose')) {				return;			}			F.unbindEvents();			if (!F.isActive) {				return;			}			if (!F.isOpen || event === true) {				&#36;('.fancybox-wrap').stop(true).trigger('onReset').remove();				F._afterZoomOut();			} else {				F.isOpen = F.isOpened = false;				F.isClosing = true;				&#36;('.fancybox-item, .fancybox-nav').remove();				F.wrap.stop(true, true).removeClass('fancybox-opened');				F.transitions[ F.current.closeMethod ]();			}		},		// Manage slideshow:		//   &#36;.fancybox.play(); - toggle slideshow		//   &#36;.fancybox.play( true ); - start		//   &#36;.fancybox.play( false ); - stop		play: function ( action ) {			var clear = function () {					clearTimeout(F.player.timer);				},				set = function () {					clear();					if (F.current &amp;&amp; F.player.isActive) {						F.player.timer = setTimeout(F.next, F.current.playSpeed);					}				},				stop = function () {					clear();					D.unbind('.player');					F.player.isActive = false;					F.trigger('onPlayEnd');				},				start = function () {					if (F.current &amp;&amp; (F.current.loop || F.current.index &lt; F.group.length - 1)) {						F.player.isActive = true;						D.bind({							'onCancel.player beforeClose.player' : stop,							'onUpdate.player'   : set,							'beforeLoad.player' : clear						});						set();						F.trigger('onPlayStart');					}				};			if (action === true || (!F.player.isActive &amp;&amp; action !== false)) {				start();			} else {				stop();			}		},		// Navigate to next gallery item		next: function ( direction ) {			var current = F.current;			if (current) {				if (!isString(direction)) {					direction = current.direction.next;				}				F.jumpto(current.index &#43; 1, direction, 'next');			}		},		// Navigate to previous gallery item		prev: function ( direction ) {			var current = F.current;			if (current) {				if (!isString(direction)) {					direction = current.direction.prev;				}				F.jumpto(current.index - 1, direction, 'prev');			}		},		// Navigate to gallery item by index		jumpto: function ( index, direction, router ) {			var current = F.current;			if (!current) {				return;			}			index = getScalar(index);			F.direction = direction || current.direction[ (index &gt;= current.index ? 'next' : 'prev') ];			F.router    = router || 'jumpto';			if (current.loop) {				if (index &lt; 0) {					index = current.group.length &#43; (index % current.group.length);				}				index = index % current.group.length;			}			if (current.group[ index ] !== undefined) {				F.cancel();				F._start(index);			}		},		// Center inside viewport and toggle position type to fixed or absolute if needed		reposition: function (e, onlyAbsolute) {			var current = F.current,				wrap    = current ? current.wrap : null,				pos;			if (wrap) {				pos = F._getPosition(onlyAbsolute);				if (e &amp;&amp; e.type === 'scroll') {					delete pos.position;					wrap.stop(true, true).animate(pos, 200);				} else {					wrap.css(pos);					current.pos = &#36;.extend({}, current.dim, pos);				}			}		},		update: function (e) {			var type = (e &amp;&amp; e.type),				anyway = !type || type === 'orientationchange';			if (anyway) {				clearTimeout(didUpdate);				didUpdate = null;			}			if (!F.isOpen || didUpdate) {				return;			}			didUpdate = setTimeout(function() {				var current = F.current;				if (!current || F.isClosing) {					return;				}				F.wrap.removeClass('fancybox-tmp');				if (anyway || type === 'load' || (type === 'resize' &amp;&amp; current.autoResize)) {					F._setDimension();				}				if (!(type === 'scroll' &amp;&amp; current.canShrink)) {					F.reposition(e);				}				F.trigger('onUpdate');				didUpdate = null;			}, (anyway &amp;&amp; !isTouch ? 0 : 300));		},		// Shrink content to fit inside viewport or restore if resized		toggle: function ( action ) {			if (F.isOpen) {				F.current.fitToView = &#36;.type(action) === &quot;boolean&quot; ? action : !F.current.fitToView;				// Help browser to restore document dimensions				if (isTouch) {					F.wrap.removeAttr('style').addClass('fancybox-tmp');					F.trigger('onUpdate');				}				F.update();			}		},		hideLoading: function () {			D.unbind('.loading');			&#36;('#fancybox-loading').remove();		},		showLoading: function () {			var el, viewport;			F.hideLoading();			el = &#36;('&lt;div id=&quot;fancybox-loading&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;').click(F.cancel).appendTo('body');			// If user will press the escape-button, the request will be canceled			D.bind('keydown.loading', function(e) {				if ((e.which || e.keyCode) === 27) {					e.preventDefault();					F.cancel();				}			});			if (!F.defaults.fixed) {				viewport = F.getViewport();				el.css({					position : 'absolute',					top  : (viewport.h * 0.5) &#43; viewport.y,					left : (viewport.w * 0.5) &#43; viewport.x				});			}		},		getViewport: function () {			var locked = (F.current &amp;&amp; F.current.locked) || false,				rez    = {					x: W.scrollLeft(),					y: W.scrollTop()				};			if (locked) {				rez.w = locked[0].clientWidth;				rez.h = locked[0].clientHeight;			} else {				// See http://bugs.jquery.com/ticket/6724				rez.w = isTouch &amp;&amp; window.innerWidth  ? window.innerWidth  : W.width();				rez.h = isTouch &amp;&amp; window.innerHeight ? window.innerHeight : W.height();			}			return rez;		},		// Unbind the keyboard / clicking actions		unbindEvents: function () {			if (F.wrap &amp;&amp; isQuery(F.wrap)) {				F.wrap.unbind('.fb');			}			D.unbind('.fb');			W.unbind('.fb');		},		bindEvents: function () {			var current = F.current,				keys;			if (!current) {				return;			}			// Changing document height on iOS devices triggers a 'resize' event,			// that can change document height... repeating infinitely			W.bind('orientationchange.fb' &#43; (isTouch ? '' : ' resize.fb') &#43; (current.autoCenter &amp;&amp; !current.locked ? ' scroll.fb' : ''), F.update);			keys = current.keys;			if (keys) {				D.bind('keydown.fb', function (e) {					var code   = e.which || e.keyCode,						target = e.target || e.srcElement;					// Skip esc key if loading, because showLoading will cancel preloading					if (code === 27 &amp;&amp; F.coming) {						return false;					}					// Ignore key combinations and key events within form elements					if (!e.ctrlKey &amp;&amp; !e.altKey &amp;&amp; !e.shiftKey &amp;&amp; !e.metaKey &amp;&amp; !(target &amp;&amp; (target.type || &#36;(target).is('[contenteditable]')))) {						&#36;.each(keys, function(i, val) {							if (current.group.length &gt; 1 &amp;&amp; val[ code ] !== undefined) {								F[ i ]( val[ code ] );								e.preventDefault();								return false;							}							if (&#36;.inArray(code, val) &gt; -1) {								F[ i ] ();								e.preventDefault();								return false;							}						});					}				});			}			if (&#36;.fn.mousewheel &amp;&amp; current.mouseWheel) {				F.wrap.bind('mousewheel.fb', function (e, delta, deltaX, deltaY) {					var target = e.target || null,						parent = &#36;(target),						canScroll = false;					while (parent.length) {						if (canScroll || parent.is('.fancybox-skin') || parent.is('.fancybox-wrap')) {							break;						}						canScroll = isScrollable( parent[0] );						parent    = &#36;(parent).parent();					}					if (delta !== 0 &amp;&amp; !canScroll) {						if (F.group.length &gt; 1 &amp;&amp; !current.canShrink) {							if (deltaY &gt; 0 || deltaX &gt; 0) {								F.prev( deltaY &gt; 0 ? 'down' : 'left' );							} else if (deltaY &lt; 0 || deltaX &lt; 0) {								F.next( deltaY &lt; 0 ? 'up' : 'right' );							}							e.preventDefault();						}					}				});			}		},		trigger: function (event, o) {			var ret, obj = o || F.coming || F.current;			if (!obj) {				return;			}			if (&#36;.isFunction( obj[event] )) {				ret = obj[event].apply(obj, Array.prototype.slice.call(arguments, 1));			}			if (ret === false) {				return false;			}			if (obj.helpers) {				&#36;.each(obj.helpers, function (helper, opts) {					if (opts &amp;&amp; F.helpers[helper] &amp;&amp; &#36;.isFunction(F.helpers[helper][event])) {						F.helpers[helper][event](&#36;.extend(true, {}, F.helpers[helper].defaults, opts), obj);					}				});			}			D.trigger(event);		},		isImage: function (str) {			return isString(str) &amp;&amp; str.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?&#36;)/i);		},		isSWF: function (str) {			return isString(str) &amp;&amp; str.match(/\.(swf)((\?|#).*)?&#36;/i);		},		_start: function (index) {			var coming = {},				obj,				href,				type,				margin,				padding;			index = getScalar( index );			obj   = F.group[ index ] || null;			if (!obj) {				return false;			}			coming = &#36;.extend(true, {}, F.opts, obj);			// Convert margin and padding properties to array - top, right, bottom, left			margin  = coming.margin;			padding = coming.padding;			if (&#36;.type(margin) === 'number') {				coming.margin = [margin, margin, margin, margin];			}			if (&#36;.type(padding) === 'number') {				coming.padding = [padding, padding, padding, padding];			}			// 'modal' propery is just a shortcut			if (coming.modal) {				&#36;.extend(true, coming, {					closeBtn   : false,					closeClick : false,					nextClick  : false,					arrows     : false,					mouseWheel : false,					keys       : null,					helpers: {						overlay : {							closeClick : false						}					}				});			}			// 'autoSize' property is a shortcut, too			if (coming.autoSize) {				coming.autoWidth = coming.autoHeight = true;			}			if (coming.width === 'auto') {				coming.autoWidth = true;			}			if (coming.height === 'auto') {				coming.autoHeight = true;			}			/*			 * Add reference to the group, so it`s possible to access from callbacks, example:			 * afterLoad : function() {			 *     this.title = 'Image ' &#43; (this.index &#43; 1) &#43; ' of ' &#43; this.group.length &#43; (this.title ? ' - ' &#43; this.title : '');			 * }			 */			coming.group  = F.group;			coming.index  = index;			// Give a chance for callback or helpers to update coming item (type, title, etc)			F.coming = coming;			if (false === F.trigger('beforeLoad')) {				F.coming = null;				return;			}			type = coming.type;			href = coming.href;			if (!type) {				F.coming = null;				//If we can not determine content type then drop silently or display next/prev item if looping through gallery				if (F.current &amp;&amp; F.router &amp;&amp; F.router !== 'jumpto') {					F.current.index = index;					return F[ F.router ]( F.direction );				}				return false;			}			F.isActive = true;			if (type === 'image' || type === 'swf') {				coming.autoHeight = coming.autoWidth = false;				coming.scrolling  = 'visible';			}			if (type === 'image') {				coming.aspectRatio = true;			}			if (type === 'iframe' &amp;&amp; isTouch) {				coming.scrolling = 'scroll';			}			// Build the neccessary markup			coming.wrap = &#36;(coming.tpl.wrap).addClass('fancybox-' &#43; (isTouch ? 'mobile' : 'desktop') &#43; ' fancybox-type-' &#43; type &#43; ' fancybox-tmp ' &#43; coming.wrapCSS).appendTo( coming.parent || 'body' );			&#36;.extend(coming, {				skin  : &#36;('.fancybox-skin',  coming.wrap),				outer : &#36;('.fancybox-outer', coming.wrap),				inner : &#36;('.fancybox-inner', coming.wrap)			});			&#36;.each([&quot;Top&quot;, &quot;Right&quot;, &quot;Bottom&quot;, &quot;Left&quot;], function(i, v) {				coming.skin.css('padding' &#43; v, getValue(coming.padding[ i ]));			});			F.trigger('onReady');			// Check before try to load; 'inline' and 'html' types need content, others - href			if (type === 'inline' || type === 'html') {				if (!coming.content || !coming.content.length) {					return F._error( 'content' );				}			} else if (!href) {				return F._error( 'href' );			}			if (type === 'image') {				F._loadImage();			} else if (type === 'ajax') {				F._loadAjax();			} else if (type === 'iframe') {				F._loadIframe();			} else {				F._afterLoad();			}		},		_error: function ( type ) {			&#36;.extend(F.coming, {				type       : 'html',				autoWidth  : true,				autoHeight : true,				minWidth   : 0,				minHeight  : 0,				scrolling  : 'no',				hasError   : type,				content    : F.coming.tpl.error			});			F._afterLoad();		},		_loadImage: function () {			// Reset preload image so it is later possible to check &quot;complete&quot; property			var img = F.imgPreload = new Image();			img.onload = function () {				this.onload = this.onerror = null;				F.coming.width  = this.width / F.opts.pixelRatio;				F.coming.height = this.height / F.opts.pixelRatio;				F._afterLoad();			};			img.onerror = function () {				this.onload = this.onerror = null;				F._error( 'image' );			};			img.src = F.coming.href;			if (img.complete !== true) {				F.showLoading();			}		},		_loadAjax: function () {			var coming = F.coming;			F.showLoading();			F.ajaxLoad = &#36;.ajax(&#36;.extend({}, coming.ajax, {				url: coming.href,				error: function (jqXHR, textStatus) {					if (F.coming &amp;&amp; textStatus !== 'abort') {						F._error( 'ajax', jqXHR );					} else {						F.hideLoading();					}				},				success: function (data, textStatus) {					if (textStatus === 'success') {						coming.content = data;						F._afterLoad();					}				}			}));		},		_loadIframe: function() {			var coming = F.coming,				iframe = &#36;(coming.tpl.iframe.replace(/\{rnd\}/g, new Date().getTime()))					.attr('scrolling', isTouch ? 'auto' : coming.iframe.scrolling)					.attr('src', coming.href);			// This helps IE			&#36;(coming.wrap).bind('onReset', function () {				try {					&#36;(this).find('iframe').hide().attr('src', '//about:blank').end().empty();				} catch (e) {}			});			if (coming.iframe.preload) {				F.showLoading();				iframe.one('load', function() {					&#36;(this).data('ready', 1);					// iOS will lose scrolling if we resize					if (!isTouch) {						&#36;(this).bind('load.fb', F.update);					}					// Without this trick:					//   - iframe won't scroll on iOS devices					//   - IE7 sometimes displays empty iframe					&#36;(this).parents('.fancybox-wrap').width('100%').removeClass('fancybox-tmp').show();					F._afterLoad();				});			}			coming.content = iframe.appendTo( coming.inner );			if (!coming.iframe.preload) {				F._afterLoad();			}		},		_preloadImages: function() {			var group   = F.group,				current = F.current,				len     = group.length,				cnt     = current.preload ? Math.min(current.preload, len - 1) : 0,				item,				i;			for (i = 1; i &lt;= cnt; i &#43;= 1) {				item = group[ (current.index &#43; i ) % len ];				if (item.type === 'image' &amp;&amp; item.href) {					new Image().src = item.href;				}			}		},		_afterLoad: function () {			var coming   = F.coming,				previous = F.current,				placeholder = 'fancybox-placeholder',				current,				content,				type,				scrolling,				href,				embed;			F.hideLoading();			if (!coming || F.isActive === false) {				return;			}			if (false === F.trigger('afterLoad', coming, previous)) {				coming.wrap.stop(true).trigger('onReset').remove();				F.coming = null;				return;			}			if (previous) {				F.trigger('beforeChange', previous);				previous.wrap.stop(true).removeClass('fancybox-opened')					.find('.fancybox-item, .fancybox-nav')					.remove();			}			F.unbindEvents();			current   = coming;			content   = coming.content;			type      = coming.type;			scrolling = coming.scrolling;			&#36;.extend(F, {				wrap  : current.wrap,				skin  : current.skin,				outer : current.outer,				inner : current.inner,				current  : current,				previous : previous			});			href = current.href;			switch (type) {				case 'inline':				case 'ajax':				case 'html':					if (current.selector) {						content = &#36;('&lt;div&gt;').html(content).find(current.selector);					} else if (isQuery(content)) {						if (!content.data(placeholder)) {							content.data(placeholder, &#36;('&lt;div class=&quot;' &#43; placeholder &#43; '&quot;&gt;&lt;/div&gt;').insertAfter( content ).hide() );						}						content = content.show().detach();						current.wrap.bind('onReset', function () {							if (&#36;(this).find(content).length) {								content.hide().replaceAll( content.data(placeholder) ).data(placeholder, false);							}						});					}				break;				case 'image':					content = current.tpl.image.replace('{href}', href);				break;				case 'swf':					content = '&lt;object id=&quot;fancybox-swf&quot; classid=&quot;clsid:D27CDB6E-AE6D-11cf-96B8-444553540000&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;&lt;param name=&quot;movie&quot; value=&quot;' &#43; href &#43; '&quot;&gt;&lt;/param&gt;';					embed   = '';					&#36;.each(current.swf, function(name, val) {						content &#43;= '&lt;param name=&quot;' &#43; name &#43; '&quot; value=&quot;' &#43; val &#43; '&quot;&gt;&lt;/param&gt;';						embed   &#43;= ' ' &#43; name &#43; '=&quot;' &#43; val &#43; '&quot;';					});					content &#43;= '&lt;embed src=&quot;' &#43; href &#43; '&quot; type=&quot;application/x-shockwave-flash&quot; width=&quot;100%&quot; height=&quot;100%&quot;' &#43; embed &#43; '&gt;&lt;/embed&gt;&lt;/object&gt;';				break;			}			if (!(isQuery(content) &amp;&amp; content.parent().is(current.inner))) {				current.inner.append( content );			}			// Give a chance for helpers or callbacks to update elements			F.trigger('beforeShow');			// Set scrolling before calculating dimensions			current.inner.css('overflow', scrolling === 'yes' ? 'scroll' : (scrolling === 'no' ? 'hidden' : scrolling));			// Set initial dimensions and start position			F._setDimension();			F.reposition();			F.isOpen = false;			F.coming = null;			F.bindEvents();			if (!F.isOpened) {				&#36;('.fancybox-wrap').not( current.wrap ).stop(true).trigger('onReset').remove();			} else if (previous.prevMethod) {				F.transitions[ previous.prevMethod ]();			}			F.transitions[ F.isOpened ? current.nextMethod : current.openMethod ]();			F._preloadImages();		},		_setDimension: function () {			var viewport   = F.getViewport(),				steps      = 0,				canShrink  = false,				canExpand  = false,				wrap       = F.wrap,				skin       = F.skin,				inner      = F.inner,				current    = F.current,				width      = current.width,				height     = current.height,				minWidth   = current.minWidth,				minHeight  = current.minHeight,				maxWidth   = current.maxWidth,				maxHeight  = current.maxHeight,				scrolling  = current.scrolling,				scrollOut  = current.scrollOutside ? current.scrollbarWidth : 0,				margin     = current.margin,				wMargin    = getScalar(margin[1] &#43; margin[3]),				hMargin    = getScalar(margin[0] &#43; margin[2]),				wPadding,				hPadding,				wSpace,				hSpace,				origWidth,				origHeight,				origMaxWidth,				origMaxHeight,				ratio,				width_,				height_,				maxWidth_,				maxHeight_,				iframe,				body;			// Reset dimensions so we could re-check actual size			wrap.add(skin).add(inner).width('auto').height('auto').removeClass('fancybox-tmp');			wPadding = getScalar(skin.outerWidth(true)  - skin.width());			hPadding = getScalar(skin.outerHeight(true) - skin.height());			// Any space between content and viewport (margin, padding, border, title)			wSpace = wMargin &#43; wPadding;			hSpace = hMargin &#43; hPadding;			origWidth  = isPercentage(width)  ? (viewport.w - wSpace) * getScalar(width)  / 100 : width;			origHeight = isPercentage(height) ? (viewport.h - hSpace) * getScalar(height) / 100 : height;			if (current.type === 'iframe') {				iframe = current.content;				if (current.autoHeight &amp;&amp; iframe.data('ready') === 1) {					try {						if (iframe[0].contentWindow.document.location) {							inner.width( origWidth ).height(9999);							body = iframe.contents().find('body');							if (scrollOut) {								body.css('overflow-x', 'hidden');							}							origHeight = body.outerHeight(true);						}					} catch (e) {}				}			} else if (current.autoWidth || current.autoHeight) {				inner.addClass( 'fancybox-tmp' );				// Set width or height in case we need to calculate only one dimension				if (!current.autoWidth) {					inner.width( origWidth );				}				if (!current.autoHeight) {					inner.height( origHeight );				}				if (current.autoWidth) {					origWidth = inner.width();				}				if (current.autoHeight) {					origHeight = inner.height();				}				inner.removeClass( 'fancybox-tmp' );			}			width  = getScalar( origWidth );			height = getScalar( origHeight );			ratio  = origWidth / origHeight;			// Calculations for the content			minWidth  = getScalar(isPercentage(minWidth) ? getScalar(minWidth, 'w') - wSpace : minWidth);			maxWidth  = getScalar(isPercentage(maxWidth) ? getScalar(maxWidth, 'w') - wSpace : maxWidth);			minHeight = getScalar(isPercentage(minHeight) ? getScalar(minHeight, 'h') - hSpace : minHeight);			maxHeight = getScalar(isPercentage(maxHeight) ? getScalar(maxHeight, 'h') - hSpace : maxHeight);			// These will be used to determine if wrap can fit in the viewport			origMaxWidth  = maxWidth;			origMaxHeight = maxHeight;			if (current.fitToView) {				maxWidth  = Math.min(viewport.w - wSpace, maxWidth);				maxHeight = Math.min(viewport.h - hSpace, maxHeight);			}			maxWidth_  = viewport.w - wMargin;			maxHeight_ = viewport.h - hMargin;			if (current.aspectRatio) {				if (width &gt; maxWidth) {					width  = maxWidth;					height = getScalar(width / ratio);				}				if (height &gt; maxHeight) {					height = maxHeight;					width  = getScalar(height * ratio);				}				if (width &lt; minWidth) {					width  = minWidth;					height = getScalar(width / ratio);				}				if (height &lt; minHeight) {					height = minHeight;					width  = getScalar(height * ratio);				}			} else {				width = Math.max(minWidth, Math.min(width, maxWidth));				if (current.autoHeight &amp;&amp; current.type !== 'iframe') {					inner.width( width );					height = inner.height();				}				height = Math.max(minHeight, Math.min(height, maxHeight));			}			// Try to fit inside viewport (including the title)			if (current.fitToView) {				inner.width( width ).height( height );				wrap.width( width &#43; wPadding );				// Real wrap dimensions				width_  = wrap.width();				height_ = wrap.height();				if (current.aspectRatio) {					while ((width_ &gt; maxWidth_ || height_ &gt; maxHeight_) &amp;&amp; width &gt; minWidth &amp;&amp; height &gt; minHeight) {						if (steps&#43;&#43; &gt; 19) {							break;						}						height = Math.max(minHeight, Math.min(maxHeight, height - 10));						width  = getScalar(height * ratio);						if (width &lt; minWidth) {							width  = minWidth;							height = getScalar(width / ratio);						}						if (width &gt; maxWidth) {							width  = maxWidth;							height = getScalar(width / ratio);						}						inner.width( width ).height( height );						wrap.width( width &#43; wPadding );						width_  = wrap.width();						height_ = wrap.height();					}				} else {					width  = Math.max(minWidth,  Math.min(width,  width  - (width_  - maxWidth_)));					height = Math.max(minHeight, Math.min(height, height - (height_ - maxHeight_)));				}			}			if (scrollOut &amp;&amp; scrolling === 'auto' &amp;&amp; height &lt; origHeight &amp;&amp; (width &#43; wPadding &#43; scrollOut) &lt; maxWidth_) {				width &#43;= scrollOut;			}			inner.width( width ).height( height );			wrap.width( width &#43; wPadding );			width_  = wrap.width();			height_ = wrap.height();			canShrink = (width_ &gt; maxWidth_ || height_ &gt; maxHeight_) &amp;&amp; width &gt; minWidth &amp;&amp; height &gt; minHeight;			canExpand = current.aspectRatio ? (width &lt; origMaxWidth &amp;&amp; height &lt; origMaxHeight &amp;&amp; width &lt; origWidth &amp;&amp; height &lt; origHeight) : ((width &lt; origMaxWidth || height &lt; origMaxHeight) &amp;&amp; (width &lt; origWidth || height &lt; origHeight));			&#36;.extend(current, {				dim : {					width	: getValue( width_ ),					height	: getValue( height_ )				},				origWidth  : origWidth,				origHeight : origHeight,				canShrink  : canShrink,				canExpand  : canExpand,				wPadding   : wPadding,				hPadding   : hPadding,				wrapSpace  : height_ - skin.outerHeight(true),				skinSpace  : skin.height() - height			});			if (!iframe &amp;&amp; current.autoHeight &amp;&amp; height &gt; minHeight &amp;&amp; height &lt; maxHeight &amp;&amp; !canExpand) {				inner.height('auto');			}		},		_getPosition: function (onlyAbsolute) {			var current  = F.current,				viewport = F.getViewport(),				margin   = current.margin,				width    = F.wrap.width()  &#43; margin[1] &#43; margin[3],				height   = F.wrap.height() &#43; margin[0] &#43; margin[2],				rez      = {					position: 'absolute',					top  : margin[0],					left : margin[3]				};			if (current.autoCenter &amp;&amp; current.fixed &amp;&amp; !onlyAbsolute &amp;&amp; height &lt;= viewport.h &amp;&amp; width &lt;= viewport.w) {				rez.position = 'fixed';			} else if (!current.locked) {				rez.top  &#43;= viewport.y;				rez.left &#43;= viewport.x;			}			rez.top  = getValue(Math.max(rez.top,  rez.top  &#43; ((viewport.h - height) * current.topRatio)));			rez.left = getValue(Math.max(rez.left, rez.left &#43; ((viewport.w - width)  * current.leftRatio)));			return rez;		},		_afterZoomIn: function () {			var current = F.current;			if (!current) {				return;			}			F.isOpen = F.isOpened = true;			F.wrap.css('overflow', 'visible').addClass('fancybox-opened');			F.update();			// Assign a click event			if ( current.closeClick || (current.nextClick &amp;&amp; F.group.length &gt; 1) ) {				F.inner.css('cursor', 'pointer').bind('click.fb', function(e) {					if (!&#36;(e.target).is('a') &amp;&amp; !&#36;(e.target).parent().is('a')) {						e.preventDefault();						F[ current.closeClick ? 'close' : 'next' ]();					}				});			}			// Create a close button			if (current.closeBtn) {				&#36;(current.tpl.closeBtn).appendTo(F.skin).bind('click.fb', function(e) {					e.preventDefault();					F.close();				});			}			// Create navigation arrows			if (current.arrows &amp;&amp; F.group.length &gt; 1) {				if (current.loop || current.index &gt; 0) {					&#36;(current.tpl.prev).appendTo(F.outer).bind('click.fb', F.prev);				}				if (current.loop || current.index &lt; F.group.length - 1) {					&#36;(current.tpl.next).appendTo(F.outer).bind('click.fb', F.next);				}			}			F.trigger('afterShow');			// Stop the slideshow if this is the last item			if (!current.loop &amp;&amp; current.index === current.group.length - 1) {				F.play( false );			} else if (F.opts.autoPlay &amp;&amp; !F.player.isActive) {				F.opts.autoPlay = false;				F.play();			}		},		_afterZoomOut: function ( obj ) {			obj = obj || F.current;			&#36;('.fancybox-wrap').trigger('onReset').remove();			&#36;.extend(F, {				group  : {},				opts   : {},				router : false,				current   : null,				isActive  : false,				isOpened  : false,				isOpen    : false,				isClosing : false,				wrap   : null,				skin   : null,				outer  : null,				inner  : null			});			F.trigger('afterClose', obj);		}	});	/*	 *	Default transitions	 */	F.transitions = {		getOrigPosition: function () {			var current  = F.current,				element  = current.element,				orig     = current.orig,				pos      = {},				width    = 50,				height   = 50,				hPadding = current.hPadding,				wPadding = current.wPadding,				viewport = F.getViewport();			if (!orig &amp;&amp; current.isDom &amp;&amp; element.is(':visible')) {				orig = element.find('img:first');				if (!orig.length) {					orig = element;				}			}			if (isQuery(orig)) {				pos = orig.offset();				if (orig.is('img')) {					width  = orig.outerWidth();					height = orig.outerHeight();				}			} else {				pos.top  = viewport.y &#43; (viewport.h - height) * current.topRatio;				pos.left = viewport.x &#43; (viewport.w - width)  * current.leftRatio;			}			if (F.wrap.css('position') === 'fixed' || current.locked) {				pos.top  -= viewport.y;				pos.left -= viewport.x;			}			pos = {				top     : getValue(pos.top  - hPadding * current.topRatio),				left    : getValue(pos.left - wPadding * current.leftRatio),				width   : getValue(width  &#43; wPadding),				height  : getValue(height &#43; hPadding)			};			return pos;		},		step: function (now, fx) {			var ratio,				padding,				value,				prop       = fx.prop,				current    = F.current,				wrapSpace  = current.wrapSpace,				skinSpace  = current.skinSpace;			if (prop === 'width' || prop === 'height') {				ratio = fx.end === fx.start ? 1 : (now - fx.start) / (fx.end - fx.start);				if (F.isClosing) {					ratio = 1 - ratio;				}				padding = prop === 'width' ? current.wPadding : current.hPadding;				value   = now - padding;				F.skin[ prop ](  getScalar( prop === 'width' ?  value : value - (wrapSpace * ratio) ) );				F.inner[ prop ]( getScalar( prop === 'width' ?  value : value - (wrapSpace * ratio) - (skinSpace * ratio) ) );			}		},		zoomIn: function () {			var current  = F.current,				startPos = current.pos,				effect   = current.openEffect,				elastic  = effect === 'elastic',				endPos   = &#36;.extend({opacity : 1}, startPos);			// Remove &quot;position&quot; property that breaks older IE			delete endPos.position;			if (elastic) {				startPos = this.getOrigPosition();				if (current.openOpacity) {					startPos.opacity = 0.1;				}			} else if (effect === 'fade') {				startPos.opacity = 0.1;			}			F.wrap.css(startPos).animate(endPos, {				duration : effect === 'none' ? 0 : current.openSpeed,				easing   : current.openEasing,				step     : elastic ? this.step : null,				complete : F._afterZoomIn			});		},		zoomOut: function () {			var current  = F.current,				effect   = current.closeEffect,				elastic  = effect === 'elastic',				endPos   = {opacity : 0.1};			if (elastic) {				endPos = this.getOrigPosition();				if (current.closeOpacity) {					endPos.opacity = 0.1;				}			}			F.wrap.animate(endPos, {				duration : effect === 'none' ? 0 : current.closeSpeed,				easing   : current.closeEasing,				step     : elastic ? this.step : null,				complete : F._afterZoomOut			});		},		changeIn: function () {			var current   = F.current,				effect    = current.nextEffect,				startPos  = current.pos,				endPos    = { opacity : 1 },				direction = F.direction,				distance  = 200,				field;			startPos.opacity = 0.1;			if (effect === 'elastic') {				field = direction === 'down' || direction === 'up' ? 'top' : 'left';				if (direction === 'down' || direction === 'right') {					startPos[ field ] = getValue(getScalar(startPos[ field ]) - distance);					endPos[ field ]   = '&#43;=' &#43; distance &#43; 'px';				} else {					startPos[ field ] = getValue(getScalar(startPos[ field ]) &#43; distance);					endPos[ field ]   = '-=' &#43; distance &#43; 'px';				}			}			// Workaround for http://bugs.jquery.com/ticket/12273			if (effect === 'none') {				F._afterZoomIn();			} else {				F.wrap.css(startPos).animate(endPos, {					duration : current.nextSpeed,					easing   : current.nextEasing,					complete : F._afterZoomIn				});			}		},		changeOut: function () {			var previous  = F.previous,				effect    = previous.prevEffect,				endPos    = { opacity : 0.1 },				direction = F.direction,				distance  = 200;			if (effect === 'elastic') {				endPos[ direction === 'down' || direction === 'up' ? 'top' : 'left' ] = ( direction === 'up' || direction === 'left' ? '-' : '&#43;' ) &#43; '=' &#43; distance &#43; 'px';			}			previous.wrap.animate(endPos, {				duration : effect === 'none' ? 0 : previous.prevSpeed,				easing   : previous.prevEasing,				complete : function () {					&#36;(this).trigger('onReset').remove();				}			});		}	};	/*	 *	Overlay helper	 */	F.helpers.overlay = {		defaults : {			closeClick : true,      // if true, fancyBox will be closed when user clicks on the overlay			speedOut   : 200,       // duration of fadeOut animation			showEarly  : true,      // indicates if should be opened immediately or wait until the content is ready			css        : {},        // custom CSS properties			locked     : !isTouch,  // if true, the content will be locked into overlay			fixed      : true       // if false, the overlay CSS position property will not be set to &quot;fixed&quot;		},		overlay : null,      // current handle		fixed   : false,     // indicates if the overlay has position &quot;fixed&quot;		el      : &#36;('html'), // element that contains &quot;the lock&quot;		// Public methods		create : function(opts) {			opts = &#36;.extend({}, this.defaults, opts);			if (this.overlay) {				this.close();			}			this.overlay = &#36;('&lt;div class=&quot;fancybox-overlay&quot;&gt;&lt;/div&gt;').appendTo( F.coming ? F.coming.parent : opts.parent );			this.fixed   = false;			if (opts.fixed &amp;&amp; F.defaults.fixed) {				this.overlay.addClass('fancybox-overlay-fixed');				this.fixed = true;			}		},		open : function(opts) {			var that = this;			opts = &#36;.extend({}, this.defaults, opts);			if (this.overlay) {				this.overlay.unbind('.overlay').width('auto').height('auto');			} else {				this.create(opts);			}			if (!this.fixed) {				W.bind('resize.overlay', &#36;.proxy( this.update, this) );				this.update();			}			if (opts.closeClick) {				this.overlay.bind('click.overlay', function(e) {					if (&#36;(e.target).hasClass('fancybox-overlay')) {						if (F.isActive) {							F.close();						} else {							that.close();						}						return false;					}				});			}			this.overlay.css( opts.css ).show();		},		close : function() {			var scrollV, scrollH;			W.unbind('resize.overlay');			if (this.el.hasClass('fancybox-lock')) {				&#36;('.fancybox-margin').removeClass('fancybox-margin');				scrollV = W.scrollTop();				scrollH = W.scrollLeft();				this.el.removeClass('fancybox-lock');				W.scrollTop( scrollV ).scrollLeft( scrollH );			}			&#36;('.fancybox-overlay').remove().hide();			&#36;.extend(this, {				overlay : null,				fixed   : false			});		},		// Private, callbacks		update : function () {			var width = '100%', offsetWidth;			// Reset width/height so it will not mess			this.overlay.width(width).height('100%');			// jQuery does not return reliable result for IE			if (IE) {				offsetWidth = Math.max(document.documentElement.offsetWidth, document.body.offsetWidth);				if (D.width() &gt; offsetWidth) {					width = D.width();				}			} else if (D.width() &gt; W.width()) {				width = D.width();			}			this.overlay.width(width).height(D.height());		},		// This is where we can manipulate DOM, because later it would cause iframes to reload		onReady : function (opts, obj) {			var overlay = this.overlay;			&#36;('.fancybox-overlay').stop(true, true);			if (!overlay) {				this.create(opts);			}			if (opts.locked &amp;&amp; this.fixed &amp;&amp; obj.fixed) {				if (!overlay) {					this.margin = D.height() &gt; W.height() ? &#36;('html').css('margin-right').replace(&quot;px&quot;, &quot;&quot;) : false;				}				obj.locked = this.overlay.append( obj.wrap );				obj.fixed  = false;			}			if (opts.showEarly === true) {				this.beforeShow.apply(this, arguments);			}		},		beforeShow : function(opts, obj) {			var scrollV, scrollH;			if (obj.locked) {				if (this.margin !== false) {					&#36;('*').filter(function(){						return (&#36;(this).css('position') === 'fixed' &amp;&amp; !&#36;(this).hasClass(&quot;fancybox-overlay&quot;) &amp;&amp; !&#36;(this).hasClass(&quot;fancybox-wrap&quot;) );					}).addClass('fancybox-margin');					this.el.addClass('fancybox-margin');				}				scrollV = W.scrollTop();				scrollH = W.scrollLeft();				this.el.addClass('fancybox-lock');				W.scrollTop( scrollV ).scrollLeft( scrollH );			}			this.open(opts);		},		onUpdate : function() {			if (!this.fixed) {				this.update();			}		},		afterClose: function (opts) {			// Remove overlay if exists and fancyBox is not opening			// (e.g., it is not being open using afterClose callback)			//if (this.overlay &amp;&amp; !F.isActive) {			if (this.overlay &amp;&amp; !F.coming) {				this.overlay.fadeOut(opts.speedOut, &#36;.proxy( this.close, this ));			}		}	};	/*	 *	Title helper	 */	F.helpers.title = {		defaults : {			type     : 'float', // 'float', 'inside', 'outside' or 'over',			position : 'bottom' // 'top' or 'bottom'		},		beforeShow: function (opts) {			var current = F.current,				text    = current.title,				type    = opts.type,				title,				target;			if (&#36;.isFunction(text)) {				text = text.call(current.element, current);			}			if (!isString(text) || &#36;.trim(text) === '') {				return;			}			title = &#36;('&lt;div class=&quot;fancybox-title fancybox-title-' &#43; type &#43; '-wrap&quot;&gt;' &#43; text &#43; '&lt;/div&gt;');			switch (type) {				case 'inside':					target = F.skin;				break;				case 'outside':					target = F.wrap;				break;				case 'over':					target = F.inner;				break;				default: // 'float'					target = F.skin;					title.appendTo('body');					if (IE) {						title.width( title.width() );					}					title.wrapInner('&lt;span class=&quot;child&quot;&gt;&lt;/span&gt;');					//Increase bottom margin so this title will also fit into viewport					F.current.margin[2] &#43;= Math.abs( getScalar(title.css('margin-bottom')) );				break;			}			title[ (opts.position === 'top' ? 'prependTo'  : 'appendTo') ](target);		}	};	// jQuery plugin initialization	&#36;.fn.fancybox = function (options) {		var index,			that     = &#36;(this),			selector = this.selector || '',			run      = function(e) {				var what = &#36;(this).blur(), idx = index, relType, relVal;				if (!(e.ctrlKey || e.altKey || e.shiftKey || e.metaKey) &amp;&amp; !what.is('.fancybox-wrap')) {					relType = options.groupAttr || 'data-fancybox-group';					relVal  = what.attr(relType);					if (!relVal) {						relType = 'rel';						relVal  = what.get(0)[ relType ];					}					if (relVal &amp;&amp; relVal !== '' &amp;&amp; relVal !== 'nofollow') {						what = selector.length ? &#36;(selector) : that;						what = what.filter('[' &#43; relType &#43; '=&quot;' &#43; relVal &#43; '&quot;]');						idx  = what.index(this);					}					options.index = idx;					// Stop an event from bubbling if everything is fine					if (F.open(what, options) !== false) {						e.preventDefault();					}				}			};		options = options || {};		index   = options.index || 0;		if (!selector || options.live === false) {			that.unbind('click.fb-start').bind('click.fb-start', run);		} else {			D.undelegate(selector, 'click.fb-start').delegate(selector &#43; &quot;:not('.fancybox-item, .fancybox-nav')&quot;, 'click.fb-start', run);		}		this.filter('[data-fancybox-start=1]').trigger('click');		return this;	};	// Tests that need a body at doc ready	D.ready(function() {		var w1, w2;		if ( &#36;.scrollbarWidth === undefined ) {			// http://benalman.com/projects/jquery-misc-plugins/#scrollbarwidth			&#36;.scrollbarWidth = function() {				var parent = &#36;('&lt;div style=&quot;width:50px;height:50px;overflow:auto&quot;&gt;&lt;div/&gt;&lt;/div&gt;').appendTo('body'),					child  = parent.children(),					width  = child.innerWidth() - child.height( 99 ).innerWidth();				parent.remove();				return width;			};		}		if ( &#36;.support.fixedPosition === undefined ) {			&#36;.support.fixedPosition = (function() {				var elem  = &#36;('&lt;div style=&quot;position:fixed;top:20px;&quot;&gt;&lt;/div&gt;').appendTo('body'),					fixed = ( elem[0].offsetTop === 20 || elem[0].offsetTop === 15 );				elem.remove();				return fixed;			}());		}		&#36;.extend(F.defaults, {			scrollbarWidth : &#36;.scrollbarWidth(),			fixed  : &#36;.support.fixedPosition,			parent : &#36;('body')		});		//Get real width of page scroll-bar		w1 = &#36;(window).width();		H.addClass('fancybox-lock-test');		w2 = &#36;(window).width();		H.removeClass('fancybox-lock-test');		&#36;(&quot;&lt;style type='text/css'&gt;.fancybox-margin{margin-right:&quot; &#43; (w2 - w1) &#43; &quot;px;}&lt;/style&gt;&quot;).appendTo(&quot;head&quot;);	});}(window, document, jQuery));Uicreep-custom.js:// NOTICE!! DO NOT USE ANY OF THIS JAVASCRIPT// IT'S ALL JUST JUNK FOR OUR DOCS!// &#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;!function (&#36;) {  &#36;(function(){    var &#36;window = &#36;(window)    // Disable certain links in docs    &#36;('section [href^=#]').click(function (e) {      e.preventDefault()    })    // side bar    &#36;('.bs-docs-sidenav').affix({      offset: {        top: function () { return &#36;window.width() &lt;= 980 ? 290 : 210 }      , bottom: 270      }    })    // make code pretty    window.prettyPrint &amp;&amp; prettyPrint()    // add-ons    &#36;('.add-on :checkbox').on('click', function () {      var &#36;this = &#36;(this)        , method = &#36;this.attr('checked') ? 'addClass' : 'removeClass'      &#36;(this).parents('.add-on')[method]('active')    })    // add tipsies to grid for scaffolding    if (&#36;('#gridSystem').length) {      &#36;('#gridSystem').tooltip({          selector: '.show-grid &gt; div'        , title: function () { return &#36;(this).width() &#43; 'px' }      })    }    // tooltip demo    &#36;('.tooltip-demo').tooltip({      selector: &quot;a[rel=tooltip]&quot;    })    &#36;('.tooltip-test').tooltip()    &#36;('.popover-test').popover()    // popover demo    &#36;(&quot;a[rel=popover]&quot;)      .popover()      .click(function(e) {        e.preventDefault()      })    // button state demo    &#36;('#fat-btn')      .click(function () {        var btn = &#36;(this)        btn.button('loading')        setTimeout(function () {          btn.button('reset')        }, 3000)      })    // carousel demo    &#36;('#myCarousel').carousel()    // javascript build logic    var inputsComponent = &#36;(&quot;#components.download input&quot;)      , inputsPlugin = &#36;(&quot;#plugins.download input&quot;)      , inputsVariables = &#36;(&quot;#variables.download input&quot;)    // toggle all plugin checkboxes    &#36;('#components.download .toggle-all').on('click', function (e) {      e.preventDefault()      inputsComponent.attr('checked', !inputsComponent.is(':checked'))    })    &#36;('#plugins.download .toggle-all').on('click', function (e) {      e.preventDefault()      inputsPlugin.attr('checked', !inputsPlugin.is(':checked'))    })    &#36;('#variables.download .toggle-all').on('click', function (e) {      e.preventDefault()      inputsVariables.val('')    })    // request built javascript    &#36;('.download-btn').on('click', function () {      var css = &#36;(&quot;#components.download input:checked&quot;)            .map(function () { return this.value })            .toArray()        , js = &#36;(&quot;#plugins.download input:checked&quot;)            .map(function () { return this.value })            .toArray()        , vars = {}        , img = ['glyphicons-halflings.png', 'glyphicons-halflings-white.png']    &#36;(&quot;#variables.download input&quot;)      .each(function () {        &#36;(this).val() &amp;&amp; (vars[ &#36;(this).prev().text() ] = &#36;(this).val())      })      &#36;.ajax({        type: 'POST'      , url: /\?dev/.test(window.location) ? 'http://localhost:3000' : 'http://bootstrap.herokuapp.com'      , dataType: 'jsonpi'      , params: {          js: js        , css: css        , vars: vars        , img: img      }      })    })  })// Modified from the original jsonpi https://github.com/benvinegar/jquery-jsonpi&#36;.ajaxTransport('jsonpi', function(opts, originalOptions, jqXHR) {  var url = opts.url;  return {    send: function(_, completeCallback) {      var name = 'jQuery_iframe_' &#43; jQuery.now()        , iframe, form      iframe = &#36;('&lt;iframe&gt;')        .attr('name', name)        .appendTo('head')      form = &#36;('&lt;form&gt;')        .attr('method', opts.type) // GET or POST        .attr('action', url)        .attr('target', name)      &#36;.each(opts.params, function(k, v) {        &#36;('&lt;input&gt;')          .attr('type', 'hidden')          .attr('name', k)          .attr('value', typeof v == 'string' ? v : JSON.stringify(v))          .appendTo(form)      })      form.appendTo('body').submit()    }  }})// &#36;(&quot;select, input:checkbox, input:radio, input:file&quot;).uniform();}(window.jQuery)// For Fancybox&#36;(&quot;.fancyMe&quot;).fancybox();&#36;(&quot;.fancyMeiframe&quot;).fancybox({      'autoScale'            : false,      'transitionIn'          : 'none',      'transitionOut'        : 'none',      'type'                 : 'iframe',      'width'                : &#43;790,      'height'               : 400,      'scrolling'            : 'no'});&#36;(&quot;.voucher&quot;).fancybox({      'autoScale'            : false,      'transitionIn'          : 'none',      'transitionOut'        : 'none',      'type'                 : 'iframe',      'width'                : &#43;430,      'height'               : 270,      'scrolling'            : 'no'});</pre><p>Then finally use this class 'fancyMeiframe' where you want to do the pop-up as follows:</p><pre class="prettyprint "> &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt;     &lt;li class=&quot;refMN&quot;&gt;&lt;a class=&quot;fancyMeiframe&quot; href=&quot;#&quot;&gt;Refer a friend &lt;/a&gt;&lt;/li&gt;     &lt;li class=&quot;reqMN&quot;&gt;&lt;a class=&quot;fancyMeiframe&quot; href=&quot;#&quot;&gt;Request a voucher&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;</pre><p>Finally keep these images to your media or whatever the folder name for images:</p><p><a>http://s8.postimg.org/bsax6pwht/fancybox_loading.gif</a></p><p><a href="http://s14.postimg.org/xoqx6uq4t/fancybox_sprite.png">http://s14.postimg.org/xoqx6uq4t/fancybox_sprite.png</a></p><p></p><p></p><p><br><br>&nbsp;</p><p></p><p></p></div>		                     </div>	    </li>        <li class="comment-wrap thread-starter  " data-postid="5996446" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996446">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="Bulldog248" href="/members/Bulldog248.aspx"><img class="post-thumb" src="/avatar/Bulldog248.jpg?forceidenticon=False&dt=635852169000000000" alt="Bulldog248" title="Bulldog248"/></a><h3 class="post-title"><a title="Bulldog248" href="/members/Bulldog248.aspx">Bulldog248</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="154 Points"></div><p class="post-points">154 Points</p><p class="post-count"><a href="/search?q=authors%3A%28Bulldog248%29&amp;s=postDate&amp;d=desc">241 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996446"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 02, 2015 12:46 AM<span class="print-only-inline"><span class="separator">&#124;</span>Bulldog248</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996446.aspx" title="Permalink to this post">LINK</a></span>        <div><p>Thanks for the response but I was hoping for something a bit shorter (and easier to follow) and in VB.</p></div>		                     </div>	    </li>        <li class="comment-wrap   " data-postid="5996485" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996485">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="TechView" href="/members/TechView.aspx"><img class="post-thumb" src="/avatar/TechView.jpg?forceidenticon=False&dt=635852169000000000" alt="TechView" title="TechView"/></a><h3 class="post-title"><a title="TechView" href="/members/TechView.aspx">TechView</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="352 Points"></div><p class="post-points">352 Points</p><p class="post-count"><a href="/search?q=authors%3A%28TechView%29&amp;s=postDate&amp;d=desc">236 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996485"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 02, 2015 04:46 AM<span class="print-only-inline"><span class="separator">&#124;</span>TechView</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996485.aspx" title="Permalink to this post">LINK</a></span>        <div>To perform it in server-side, go through this link:<br><br>http://www.aspsnippets.com/Articles/Open-New-Window-from-Server-Side-Code-Behind-in-ASPNet-using-C-and-VBNet.aspx<br></div>		                     </div>	    </li>        <li class="comment-wrap thread-starter  " data-postid="5996489" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996489">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="Bulldog248" href="/members/Bulldog248.aspx"><img class="post-thumb" src="/avatar/Bulldog248.jpg?forceidenticon=False&dt=635852169000000000" alt="Bulldog248" title="Bulldog248"/></a><h3 class="post-title"><a title="Bulldog248" href="/members/Bulldog248.aspx">Bulldog248</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="154 Points"></div><p class="post-points">154 Points</p><p class="post-count"><a href="/search?q=authors%3A%28Bulldog248%29&amp;s=postDate&amp;d=desc">241 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996489"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 02, 2015 05:12 AM<span class="print-only-inline"><span class="separator">&#124;</span>Bulldog248</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996489.aspx" title="Permalink to this post">LINK</a></span>        <div><p>That is basically how I open the window (Suppliers.aspx) from Capacitors.aspx.vb.&nbsp; I should have posted code earlier, sorry.</p><p>VB code in Capacitors.aspx.vb:</p><pre class="prettyprint ">    Protected Sub Button26_Click(sender As Object, e As System.EventArgs) Handles Button26.Click        Dim script As String = &quot;window.open('Suppliers.aspx', '_blank','scrollbars=yes');&quot;        ScriptManager.RegisterStartupScript(Me, Me.GetType(), &quot;popup&quot;, script, True)    End Sub</pre><p>The issue is closing it from Main.aspx.vb when the user clicks the &quot;Logoff&quot; button.</p><p>Logoff VB code in Main.aspx.vb:</p><pre class="prettyprint ">    Protected Sub Button13_Click(sender As Object, e As System.EventArgs) Handles Button13.Click        Dim conCString As String = ConfigurationManager.ConnectionStrings(&quot;conCString&quot;).ConnectionString        Dim sqlConnection As SqlConnection = New SqlConnection(ConfigurationManager.ConnectionStrings(&quot;conCString&quot;).ConnectionString)        Dim myDate As String = System.DateTime.Now.ToString(&quot;yyyy-MM-dd HH:mm:ss.fff&quot;)        Dim cmd As New SqlCommand        cmd.CommandType = CommandType.Text        cmd.Connection = sqlConnection        Dim querystring As String = &quot;UPDATE [Users] SET IsLoggedOn = 0 WHERE ([UserName] = N'&quot; &amp; User.Identity.Name &amp; &quot;')&quot;        sqlConnection.Open()        Dim command As New SqlCommand(querystring, sqlConnection)        Dim reader As SqlDataReader = command.ExecuteReader()        sqlConnection.Close()        'LastActivityDate        querystring = &quot;UPDATE [Users] SET LastActivityDate = N'&quot; &amp; myDate &amp; &quot;' WHERE ([UserName] = N'&quot; &amp; User.Identity.Name &amp; &quot;')&quot;        sqlConnection.Open()        command = New SqlCommand(querystring, sqlConnection)        reader = command.ExecuteReader()        sqlConnection.Close()        'Close Suppliers.aspx if open, if this is possible?        Response.Redirect(&quot;Login.aspx&quot;)    End Sub</pre><p>I hope this clarifies the issue.</p><p>Thanks!</p></div>		                     </div>	    </li>        <li class="comment-wrap   " data-postid="5996537" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996537">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="TechView" href="/members/TechView.aspx"><img class="post-thumb" src="/avatar/TechView.jpg?forceidenticon=False&dt=635852169000000000" alt="TechView" title="TechView"/></a><h3 class="post-title"><a title="TechView" href="/members/TechView.aspx">TechView</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="352 Points"></div><p class="post-points">352 Points</p><p class="post-count"><a href="/search?q=authors%3A%28TechView%29&amp;s=postDate&amp;d=desc">236 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996537"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 02, 2015 07:49 AM<span class="print-only-inline"><span class="separator">&#124;</span>TechView</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996537.aspx" title="Permalink to this post">LINK</a></span>        <div>It could be done. You may need to make the parameter 'False' in Main.aspx.vb and go through this link:<br><br>https://stackoverflow.com/questions/3936176/how-close-html-window-when-click-asp-net-button</div>		                     </div>	    </li>        <li class="comment-wrap   " data-postid="5996553" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996553">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="Fei Han - MSFT" href="/members/Fei%20Han%20-%20MSFT.aspx"><img class="post-thumb" src="/avatar/Fei%20Han%20-%20MSFT.jpg?forceidenticon=True&dt=635852169000000000" alt="Fei Han - MSFT" title="Fei Han - MSFT"/></a><h3 class="post-title"><a title="Fei Han - MSFT" href="/members/Fei%20Han%20-%20MSFT.aspx">Fei Han - MS...</a></h3><p class="post-level">All-Star</p><div class="post-rating All-Star" title="22279 Points"></div><p class="post-points">22279 Points</p><p class="post-count"><a href="/search?q=authors%3A%28Fei%20Han%20-%20MSFT%29&amp;s=postDate&amp;d=desc">2901 Posts</a></p><p class="post-badge microsoft" title="Microsoft employee">Microsoft</p>    </div>    <div class="comment-right-col">                              <a name="5996553"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 02, 2015 08:35 AM<span class="print-only-inline"><span class="separator">&#124;</span>Fei Han - MSFT</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996553.aspx" title="Permalink to this post">LINK</a></span>        <div><p>Hi,</p><p>I recommend to close the new window (popup window) in &quot;Logoff&quot; button client side click event.</p><pre class="prettyprint lang-cs">&lt;script&gt;    var myWindow;    function openwindow() {            myWindow = window.open(&quot;Suppliers.aspx&quot;, &quot;MsgWindow&quot;, &quot;width=400, height=200&quot;);    }    function closewindow() {        myWindow.close();    }&lt;/script&gt;</pre><pre class="prettyprint lang-cs">&lt;asp:Button ID=&quot;btnLogoff&quot; runat=&quot;server&quot; Text=&quot; Logoff&quot; OnClick=&quot; btnLogoff_Click&quot; OnClientClick=&quot;closewindow();&quot;/&gt;</pre><p>Besides, you could use <b><a href="https://ajaxcontroltoolkit.codeplex.com/wikipage?title=ModalPopup%20Control&amp;referringTitle=Tutorials">ModalPopupExtender</a></b> to display content in a modal dialog box, then you could call show()/hide() method to open/close the modal popup.</p><p>Best Regards,</p><p>Fei Han</p><p><br><br></p></div>		                     </div>	    </li>        <li class="comment-wrap thread-starter  " data-postid="5996642" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996642">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="Bulldog248" href="/members/Bulldog248.aspx"><img class="post-thumb" src="/avatar/Bulldog248.jpg?forceidenticon=False&dt=635852169000000000" alt="Bulldog248" title="Bulldog248"/></a><h3 class="post-title"><a title="Bulldog248" href="/members/Bulldog248.aspx">Bulldog248</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="154 Points"></div><p class="post-points">154 Points</p><p class="post-count"><a href="/search?q=authors%3A%28Bulldog248%29&amp;s=postDate&amp;d=desc">241 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996642"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 02, 2015 12:08 PM<span class="print-only-inline"><span class="separator">&#124;</span>Bulldog248</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996642.aspx" title="Permalink to this post">LINK</a></span>        <div><p>Sorry everyone but the window remains open.&nbsp; Any other suggestions?</p><p>Thanks!</p></div>		                     </div>	    </li>        <li class="comment-wrap   " data-postid="5996646" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5996646">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="mgebhard" href="/members/mgebhard.aspx"><img class="post-thumb" src="/avatar/mgebhard.jpg?forceidenticon=False&dt=635852169000000000" alt="mgebhard" title="mgebhard"/></a><h3 class="post-title"><a title="mgebhard" href="/members/mgebhard.aspx">mgebhard</a></h3><p class="post-level">Star</p><div class="post-rating Star" title="9480 Points"></div><p class="post-points">9480 Points</p><p class="post-count"><a href="/search?q=authors%3A%28mgebhard%29&amp;s=postDate&amp;d=desc">3186 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5996646"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 02, 2015 12:25 PM<span class="print-only-inline"><span class="separator">&#124;</span>mgebhard</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5996646.aspx" title="Permalink to this post">LINK</a></span>        <div><p></p><blockquote><span class="icon-blockquote"></span><h4>Bulldog248</h4><p></p><p>Sorry everyone but the window remains open.&nbsp; Any other suggestions?</p><p>Thanks!</p><p></p></blockquote><p></p><p>When a Window is open using JavaScript.&nbsp;&nbsp;window.open, you have the opportunity to assign a handler to the child window which exists in the parent. &nbsp;The handler exsits in the parent window that created child. &nbsp;</p><p>If the parent window navigates to another page then all of the previous JavaScript variables are lost, including the child window handler, and replaced by new content. &nbsp;This is how the browsers work.</p><p>You may need to adjust the design to work with the browser.</p><p>See the following references for more information.</p><p><a href="http://stackoverflow.com/questions/9364807/javascript-reference-browser-window-by-name">http://stackoverflow.com/questions/9364807/javascript-reference-browser-window-by-name</a></p><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/open">https://developer.mozilla.org/en-US/docs/Web/API/Window/open</a></p><p></p></div>		                     </div>	    </li>        <li class="comment-wrap thread-starter  " data-postid="5997216" title="">    <ul class="comment-nav">                                            <li><a href="/login/RedirectToLogin?ReturnUrl=/post/set/15/2079018/5997216">Reply</a></li>                </ul>    <div class="comment-left-col">        <a title="Bulldog248" href="/members/Bulldog248.aspx"><img class="post-thumb" src="/avatar/Bulldog248.jpg?forceidenticon=False&dt=635852169000000000" alt="Bulldog248" title="Bulldog248"/></a><h3 class="post-title"><a title="Bulldog248" href="/members/Bulldog248.aspx">Bulldog248</a></h3><p class="post-level">Member</p><div class="post-rating Member" title="154 Points"></div><p class="post-points">154 Points</p><p class="post-count"><a href="/search?q=authors%3A%28Bulldog248%29&amp;s=postDate&amp;d=desc">241 Posts</a></p>    </div>    <div class="comment-right-col">                              <a name="5997216"></a>              <h3>Re: How can I close an open popup window when the main program logs off?</h3>        <p class="date">Dec 04, 2015 12:31 AM<span class="print-only-inline"><span class="separator">&#124;</span>Bulldog248</span><span class="print-no responsive-no"><span class="separator">&#124;</span><a href="/post/5997216.aspx" title="Permalink to this post">LINK</a></span>        <div><p>I've got a method that gets me 95% of what I need, see below.&nbsp; This is in my main module and is where the main logoff occurs.&nbsp; When the user logs off the closewindow() is executed and effectively closes the popup window if it has been opened, even if elsewhere in the program from another page.&nbsp; The only issue is that if it has not been opened then it opens it and closes it quickly.&nbsp; This is what I could like to improve upon.</p><p>Is there a way to find out if the window has been opened even if in another page so if it hasn't been opened I can just skip this step?</p><pre class="prettyprint ">&lt;script type=&quot;text/javascript&quot;&gt;<br>&nbsp;&nbsp;&nbsp; var myWindow;<br><br>&nbsp;&nbsp;&nbsp; function openwindow() {<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myWindow = window.open(&quot;Suppliers.aspx&quot;, &quot;Parts&quot;, &quot;scrollbars=yes&quot;);<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; function closewindow() {<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myWindow = window.open(&quot;Suppliers.aspx&quot;, &quot;Parts&quot;, &quot;scrollbars=yes&quot;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myWindow.close();<br><br>&nbsp;&nbsp;&nbsp; }<br>&lt;/script&gt;</pre><p>Thanks!</p></div>		                     </div>	    </li>		</ul>				<div class="clear"></div>				<div class="pagination-thread"><a href="/t/prev/2079018" >‹ Previous Thread</a><span class="separator">&#124;</span><a href="/t/next/2079018" >Next Thread ›</a></div>	</div>					<div id="BottomAd" data-adtypeid="4" data-adzoneid="0" class="ad-728x90" style="width: 728px;"></div>							<footer>			<div class="footer"><div class="clear"></div><ul class="footer-menu"><li class="block"><h2>This site is managed for Microsoft by Neudesic, LLC. | &copy; 2015 Microsoft. All rights reserved.</h2></li><li><a href="//www.asp.net/privacy" data-s-object-id="footer">Privacy Statement</a><span class="separator">|</span></li><li><a href="//www.asp.net/terms-of-use" data-s-object-id="footer">Terms of Use</a><span class="separator">|</span></li><li><a href="//www.asp.net/contact-us" data-s-object-id="footer">Contact Us</a><span class="separator">|</span></li><li><a href="http://www.neudesicmediagroup.com/?site=asp#contactus" data-s-object-id="footer">Advertise With Us</a><span class="separator">|</span></li><li><a href="http://www.umbraco.org" data-s-object-id="footer">CMS by Umbraco</a><span class="separator">|</span></li><li><a href="http://azure.microsoft.com/">Hosted on Microsoft Azure</a></li></ul><ul class="footer-menu last"><li class="block"><h2><a class="logo-microsoft" title="Microsoft" href="http://microsoft.com" data-s-object-id="footer"><svg version="1.1" id="svg5358" xmlns:svg="http://www.w3.org/2000/svg"	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 220.654 220.695" enable-background="new 0 0 220.654 220.695" xml:space="preserve"><path id="path5058" fill="#F1511B" d="M104.867,104.867H0V0h104.867V104.867z"/><path id="path5060" fill="#80CC28" d="M220.654,104.867H115.787V0h104.867V104.867z"/><path id="path5062" fill="#00ADEF" d="M104.865,220.695H0V115.828h104.865V220.695z"/><path id="path5064" fill="#FBBC09" d="M220.654,220.695H115.787V115.828h104.867V220.695z"/></svg></a></h2></li><li><a href="http://aspnet.uservoice.com" data-s-object-id="footer">Feedback on ASP.NET</a><span class="separator">|</span></li><li><a href="https://connect.microsoft.com/VisualStudio" data-s-object-id="footer">File Bugs</a><span class="separator">|</span></li><li><a href="//www.asp.net/support">Support Lifecycle</a></li></ul></div>		</footer>    </div>    <script type="text/javascript">var omni_guid="4c3e0fe8-4e05-4205-960c-5dbb8a842446"; var searchDomain = "//www.asp.net";</script>		<script type="text/javascript">var omni_forumid = 15;</script>		<script type="text/javascript" src="//forums-asp.azureedge.net/resources/v-2015-12-04-001/scripts/scripts-bundle/cheetah-main.js"></script>            	            <script type="text/javascript" src="//forums-asp.azureedge.net/resources/v-2015-12-04-001/scripts/scripts-bundle/prettify.js"></script>        	<script type="text/javascript">        $(document).ready(function()        {                     //-- Scroll post route into view            var postMatches = window.location.href.match("/p/[0-9]+/([0-9]+)");            if (postMatches != null && postMatches.length > 1) {                var elem = $('a[name="' + postMatches[1] + '"]');                if (elem != null && elem.offset() != null) {                    $(document).scrollTop(elem.offset().top);                }            }			            $(".share-btn").click(function () {            	$(".share-details").slideToggle("fast");            });                    });    </script>	 <script type="text/javascript">    $(document).ready(function () {        				    });    </script>    	<script type="text/javascript">if ((Math.floor(Math.random() * 100)) < 5) { $.getScript('/v-2015-12-04-001/resources/scripts/scripts-bundle/survey.js'); }</script>    <noscript><a href="http://www.omniture.com" title="Web Analytics"><img src="//msstonojsaspnet.112.2O7.net/b/ss/msstonojsaspnet/1/H.20.2--NS/0" height="1" width="1" border="0" alt="" /></a></noscript>	<noscript><img alt="" width="1" height="1" src="//c.microsoft.com/trans_pixel.aspx"/></noscript>		<script>		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');		ga('create', 'UA-61337531-1', 'auto');		ga('send', 'pageview');	</script>		<div class="modal-cover" style="display:none;"></div></body></html>