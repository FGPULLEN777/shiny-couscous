<?xml version="1.0" encoding="utf-8"?><rss xmlns:a10="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Pass selected data back from Html.DropDownListFor and call contructor action</title><link>http://forums.asp.net/t/2079652.aspx?Pass+selected+data+back+from+Html+DropDownListFor+and+call+contructor+action</link><description /><lastBuildDate>Wed, 09 Dec 2015 08:17:55 -0800</lastBuildDate><a10:id>2079652</a10:id><item><guid isPermaLink="false">5998521</guid><link>http://forums.asp.net/p/2079652/5998521.aspx?Pass+selected+data+back+from+Html+DropDownListFor+and+call+contructor+action</link><title>Pass selected data back from Html.DropDownListFor and call contructor action</title><description>&lt;p&gt;In my view page i placed Html.DropDownListFor, it will be used to filter data. In view i am filling it from Model as following:&lt;/p&gt;&lt;pre class="default prettyprint prettyprinted"&gt;&lt;pre class="prettyprint"&gt;@Html.DropDownListFor(Function(Model) Model.Projects, New SelectList(Model.Projects, &amp;quot;Id&amp;quot;, &amp;quot;Nazwa&amp;quot;), &amp;quot;Select project&amp;quot;, New With {.class = &amp;quot;btn btn-primary dropdown-toggle&amp;quot;})&lt;/pre&gt;&lt;/pre&gt;&lt;p&gt;The problem is i have no idea how to after user select something get this id from DropDown and pass back to controller Index action?&lt;/p&gt;&lt;p&gt;This is my controller:&lt;/p&gt;&lt;pre class="default prettyprint prettyprinted"&gt;&lt;pre class="prettyprint"&gt;&lt;span class="typ"&gt;Function&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Index&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="typ"&gt;Optional&lt;/span&gt;&lt;span class="pln"&gt; projectid &lt;/span&gt;&lt;span class="typ"&gt;As&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Integer&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="lit"&gt;0&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;As&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;ActionResult&lt;/span&gt;&lt;span class="pln"&gt;        &lt;/span&gt;&lt;span class="typ"&gt;If&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Not&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;IsNothing&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="typ"&gt;Session&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str"&gt;"LogedUserId"&lt;/span&gt;&lt;span class="pun"&gt;))&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Then&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;Dim&lt;/span&gt;&lt;span class="pln"&gt; userId &lt;/span&gt;&lt;span class="typ"&gt;As&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Integer&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Session&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str"&gt;"LogedUserId"&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;Dim&lt;/span&gt;&lt;span class="pln"&gt; projectsAndTransportsLists &lt;/span&gt;&lt;span class="typ"&gt;As&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;New&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;CustomModelProjetsTransports&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;Dim&lt;/span&gt;&lt;span class="pln"&gt; transportsPerUser &lt;/span&gt;&lt;span class="typ"&gt;As&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;New&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;List&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="typ"&gt;Of&lt;/span&gt;&lt;span class="pln"&gt; tbTransport&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;Dim&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;ProjectsPerUser&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;As&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;New&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;List&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="typ"&gt;Of&lt;/span&gt;&lt;span class="pln"&gt; tbProjekt&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;If&lt;/span&gt;&lt;span class="pln"&gt; projectid &lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="lit"&gt;0&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Then&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;Else&lt;/span&gt;&lt;span class="pln"&gt;                transportsPerUser &lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="pln"&gt; db&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;Database&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;SqlQuery&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="typ"&gt;Of&lt;/span&gt;&lt;span class="pln"&gt; tbTransport&lt;/span&gt;&lt;span class="pun"&gt;)(&lt;/span&gt;&lt;span class="str"&gt;"SELECT * FROM [general].[dbo].[tbTransport] WHERE ProjectId IN "&lt;/span&gt;&lt;span class="pln"&gt; _                                                                         &lt;/span&gt;&lt;span class="pun"&gt;&amp;amp;&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="str"&gt;" (SELECT DISTINCT ProjectId FROM [general].[dbo].[tbUserProject] "&lt;/span&gt;&lt;span class="pln"&gt; _                                                                         &lt;/span&gt;&lt;span class="pun"&gt;&amp;amp;&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="str"&gt;"WHERE UserId = "&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;&amp;amp;&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Session&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str"&gt;"LogedUserId"&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;&amp;amp;&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="str"&gt;") And ProjectId = 10074"&lt;/span&gt;&lt;span class="pun"&gt;).&lt;/span&gt;&lt;span class="typ"&gt;ToList&lt;/span&gt;&lt;span class="pln"&gt;                &lt;/span&gt;&lt;span class="typ"&gt;ProjectsPerUser&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="pln"&gt; db&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;Database&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;SqlQuery&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="typ"&gt;Of&lt;/span&gt;&lt;span class="pln"&gt; tbProjekt&lt;/span&gt;&lt;span class="pun"&gt;)(&lt;/span&gt;&lt;span class="str"&gt;"SELECT * FROM [general].[dbo].[tbProjekt] where Id IN"&lt;/span&gt;&lt;span class="pln"&gt; _                                                                     &lt;/span&gt;&lt;span class="pun"&gt;&amp;amp;&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="str"&gt;"(SELECT DISTINCT ProjectId FROM [general].[dbo].[tbUserProject] WHERE UserId = "&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;&amp;amp;&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Session&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str"&gt;"LogedUserId"&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;&amp;amp;&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="str"&gt;")"&lt;/span&gt;&lt;span class="pun"&gt;).&lt;/span&gt;&lt;span class="typ"&gt;ToList&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;End&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;If&lt;/span&gt;&lt;span class="pln"&gt;            projectsAndTransportsLists&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;Projects&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;ProjectsPerUser&lt;/span&gt;&lt;span class="pln"&gt;            projectsAndTransportsLists&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;Transports&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="pln"&gt; transportsPerUser            &lt;/span&gt;&lt;span class="typ"&gt;Return&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;View&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="pln"&gt;projectsAndTransportsLists&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt;        &lt;/span&gt;&lt;span class="typ"&gt;Else&lt;/span&gt;&lt;span class="pln"&gt;            &lt;/span&gt;&lt;span class="typ"&gt;Return&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;RedirectToAction&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str"&gt;"Index"&lt;/span&gt;&lt;span class="pun"&gt;,&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="str"&gt;"Login"&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt;        &lt;/span&gt;&lt;span class="typ"&gt;End&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;If&lt;/span&gt;&lt;span class="pln"&gt;    &lt;/span&gt;&lt;span class="typ"&gt;End&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Function&lt;/span&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;EDIT:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;I tried also to add this staff but still not working:&lt;/p&gt;&lt;p&gt;additional action method:&lt;/p&gt;&lt;pre class="default prettyprint prettyprinted"&gt;&lt;pre class="prettyprint"&gt;&lt;span class="tag"&gt;&amp;lt;HttpPost&lt;/span&gt;&lt;span class="pln"&gt;()&lt;/span&gt;&lt;span class="tag"&gt;&amp;gt;&lt;/span&gt;&lt;span class="pln"&gt; _   &lt;/span&gt;&lt;span class="tag"&gt;&amp;lt;ActionName&lt;/span&gt;&lt;span class="pln"&gt;(&lt;/span&gt;&lt;span class="atv"&gt;"Index"&lt;/span&gt;&lt;span class="pln"&gt;)&lt;/span&gt;&lt;span class="tag"&gt;&amp;gt;&lt;/span&gt;&lt;span class="pln"&gt; _    Public Function IndexPost(fcii As FormCollection, Optional projectid As Integer = 0) As ActionResult        Dim Fltcode = fcii("Id")        Return View()    End Function&lt;/span&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;and in View:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class="default prettyprint prettyprinted"&gt;&lt;pre class="prettyprint"&gt;&lt;span class="lit"&gt;@Using&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="typ"&gt;Html&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;BeginForm&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str"&gt;"Index"&lt;/span&gt;&lt;span class="pun"&gt;,&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="str"&gt;"Transport"&lt;/span&gt;&lt;span class="pun"&gt;,&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;FormMethod&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;Post&lt;/span&gt;&lt;span class="pun"&gt;))&lt;/span&gt;&lt;span class="pln"&gt;    &lt;/span&gt;&lt;span class="pun"&gt;@*&lt;/span&gt;&lt;span class="lit"&gt;@Html&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;ValidationSummary&lt;/span&gt;&lt;span class="pun"&gt;()*@&lt;/span&gt;&lt;span class="pln"&gt;    &lt;/span&gt;&lt;span class="pun"&gt;@*@&amp;lt;&lt;/span&gt;&lt;span class="pln"&gt;p&lt;/span&gt;&lt;span class="pun"&gt;&amp;gt;&lt;/span&gt;&lt;span class="typ"&gt;Your&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Name&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;:&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="lit"&gt;@Html&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="typ"&gt;TextBox&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str"&gt;"Name"&lt;/span&gt;&lt;span class="pun"&gt;)&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="pln"&gt;p&lt;/span&gt;&lt;span class="pun"&gt;&amp;gt;*@&lt;/span&gt;&lt;span class="pln"&gt;    &lt;/span&gt;@Html.DropDownListFor(Function(Model) Model.Projects, New SelectList(Model.Projects, &amp;quot;Id&amp;quot;, &amp;quot;Nazwa&amp;quot;), &amp;quot;Select project&amp;quot;, New With {.class = &amp;quot;btn btn-primary dropdown-toggle&amp;quot;})&lt;span class="pln"&gt;    &lt;/span&gt;&lt;span class="pun"&gt;@&amp;lt;&lt;/span&gt;&lt;span class="pln"&gt;input type&lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="str"&gt;"submit"&lt;/span&gt;&lt;span class="pln"&gt; value&lt;/span&gt;&lt;span class="pun"&gt;=&lt;/span&gt;&lt;span class="str"&gt;"Id"&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="pun"&gt;/&amp;gt;&lt;/span&gt;&lt;span class="pln"&gt;&lt;/span&gt;&lt;span class="typ"&gt;End&lt;/span&gt;&lt;span class="pln"&gt; &lt;/span&gt;&lt;span class="typ"&gt;Using&lt;/span&gt;&lt;/pre&gt;&lt;/pre&gt;&lt;/pre&gt;</description><a10:updated>2015-12-08T18:53:37-08:00</a10:updated></item><item><guid isPermaLink="false">5998635</guid><link>http://forums.asp.net/p/2079652/5998635.aspx?Re+Pass+selected+data+back+from+Html+DropDownListFor+and+call+contructor+action</link><title>Re: Pass selected data back from Html.DropDownListFor and call contructor action</title><description>&lt;p&gt;Hi JimmyJim,&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;span class="icon-blockquote"&gt;&lt;/span&gt;&lt;h4&gt;JimmyJim&lt;/h4&gt;The problem is i have no idea how to after user select something get this id from DropDown and pass back to controller Index action?&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;I'm not sure how you design your Model. So i create a sample to show how to use it. It's really not that hard. As always you start by defining a view model:&lt;/p&gt;&lt;pre class="prettyprint "&gt;Public Class MyViewModel    Public Property SelectedItems As IEnumerable(Of String)    Public Property SelectedItem As String    Public Property Items As IEnumerable(Of SelectListItem)End Class&lt;/pre&gt;&lt;p&gt;then a controller:&lt;/p&gt;&lt;pre class="prettyprint "&gt;Public Class HomeController    Inherits System.Web.Mvc.Controller    Function Index() As ActionResult        Dim model = New MyViewModel With {            .Items = {                New SelectListItem() With {.Value = &amp;quot;1&amp;quot;, .Text = &amp;quot;item 1&amp;quot;},                New SelectListItem() With {.Value = &amp;quot;2&amp;quot;, .Text = &amp;quot;item 2&amp;quot;},                New SelectListItem() With {.Value = &amp;quot;3&amp;quot;, .Text = &amp;quot;item 3&amp;quot;}            }        }        Return View(model)    End Function    Function Index(model As MyViewModel) As ActionResult        ' Here you can use the model.SelectedItem which will        ' return you the id of the selected item from the DropDown and         ' model.SelectedItems which will return you the list of ids of        ' the selected items in the ListBox.        ...    End FunctionEnd Class&lt;/pre&gt;&lt;p&gt;and finally a corresponding strongly typed view:&lt;/p&gt;&lt;pre class="prettyprint "&gt;@ModelType MvcApplication1.MyViewModel@Using Html.BeginForm()    @Html.DropDownListFor(Function(x) x.SelectedItem, Model.Items)    @Html.ListBoxFor(Function(x) x.SelectedItems, Model.Items)    @&amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;OK&amp;quot; /&amp;gt;End Using&lt;/pre&gt;&lt;p&gt;Besides, you could also refer to the following links to learn how to p&lt;span&gt;ass selected data back from Html.DropDownListFor.&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;a href="http://stackoverflow.com/questions/14152055/how-to-use-html-dropdownlistfor-in-another"&gt;http://stackoverflow.com/questions/14152055/how-to-use-html-dropdownlistfor-in-another&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://www.dotnetcurry.com/ShowArticle.aspx?ID=466"&gt;http://www.dotnetcurry.com/ShowArticle.aspx?ID=466&lt;/a&gt;&lt;/p&gt;&lt;p&gt;I hope it's helpful to you.&lt;/p&gt;&lt;p&gt;Best Regards,&lt;/p&gt;&lt;p&gt;Klein zhang&lt;/p&gt;</description><a10:updated>2015-12-09T06:07:38-08:00</a10:updated></item><item><guid isPermaLink="false">5998672</guid><link>http://forums.asp.net/p/2079652/5998672.aspx?Re+Pass+selected+data+back+from+Html+DropDownListFor+and+call+contructor+action</link><title>Re: Pass selected data back from Html.DropDownListFor and call contructor action</title><description>&lt;p&gt;Hi Klein finally i was able to do it and i would like to show you how i acheieve that. I heard that way i did is not good approach and i know i should do it by using model and not FormCollection - could be so kind and help me to convert it to correct approach? Heres exactly what i have:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Here my two actions of controller - one is for post ack value from dropdown as you can see (IndexPst):&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class="prettyprint lang-vb"&gt;' GET: /Transport/Public Function Index() As ActionResultIf Not IsNothing(Session(&amp;quot;LogedUserId&amp;quot;)) ThenDim userId As Integer = Session(&amp;quot;LogedUserId&amp;quot;)Dim projectsAndTransportsLists As New CustomModelProjetsTransportsIf Not IsNothing(Session(&amp;quot;LogedUserId&amp;quot;)) ThenDim ProjectsPerUser As New List(Of tbProjekt)ProjectsPerUser = db.Database.SqlQuery(Of tbProjekt)(&amp;quot;SELECT * FROM [16281468_general].[dbo].[tbProjekt] WHERE Id &amp;quot; _&amp;amp; &amp;quot;IN (SELECT DISTINCT ProjectId FROM [16281468_general].[dbo].[tbUserProject] WHERE UserId = &amp;quot; &amp;amp; Session(&amp;quot;LogedUserId&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;).ToListIf ProjectsPerUser.Count &amp;gt;= 0 ThenprojectsAndTransportsLists.Projects = ProjectsPerUserprojectsAndTransportsLists.Transports = New List(Of tbTransport)Return View(projectsAndTransportsLists)ElseReturn RedirectToAction(&amp;quot;Index&amp;quot;, &amp;quot;Login&amp;quot;)End IfEnd IfReturn RedirectToAction(&amp;quot;Index&amp;quot;, &amp;quot;Login&amp;quot;)ElseReturn RedirectToAction(&amp;quot;Index&amp;quot;, &amp;quot;Login&amp;quot;)End IfEnd Function&amp;lt;HttpPost()&amp;gt; _&amp;lt;ActionName(&amp;quot;Index&amp;quot;)&amp;gt; _Public Function IndexPost(fc As FormCollection) As ActionResultIf (ModelState.IsValid) ThenIf IsNumeric(fc(0)) ThenDim idPojektu As Integer = fc(0) ' ==== &amp;gt; fc(0) - project idIf Not IsNothing(Session(&amp;quot;LogedUserId&amp;quot;)) ThenDim userId As Integer = Session(&amp;quot;LogedUserId&amp;quot;)Dim projectsAndTransportsLists As New CustomModelProjetsTransportsDim transportsPerUser As New List(Of tbTransport)Dim ProjectsPerUser As New List(Of tbProjekt)If idPojektu = 0 Then '--All belong to user'Get all transport data belongs to user (from session)'transportsPerUser = db.Database.SqlQuery(Of tbTransport)(&amp;quot;SELECT * FROM [16281468_general].[dbo].[tbTransport] WHERE ProjectId IN &amp;quot; _' &amp;amp; &amp;quot;(SELECT DISTINCT ProjectId FROM [16281468_general].[dbo].[tbUserProject] WHERE UserId = &amp;quot; &amp;amp; Session(&amp;quot;LogedUserId&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;).ToListProjectsPerUser = db.Database.SqlQuery(Of tbProjekt)(&amp;quot;SELECT * FROM [16281468_general].[dbo].[tbProjekt] WHERE Id &amp;quot; _&amp;amp; &amp;quot;IN (SELECT DISTINCT ProjectId FROM [16281468_general].[dbo].[tbUserProject] WHERE UserId = &amp;quot; &amp;amp; Session(&amp;quot;LogedUserId&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;).ToListElse'wszystkie nalezace do tego usera -&amp;gt; nie wszystkie tylko ten projekt ktoy wybral user z dropddown (ze wszystkich ktore naleza do usera) transportsPerUser = db.Database.SqlQuery(Of tbTransport)(&amp;quot;SELECT * FROM [16281468_general].[dbo].[tbTransport] WHERE ProjectId IN &amp;quot; _&amp;amp; &amp;quot; (SELECT DISTINCT ProjectId FROM [16281468_general].[dbo].[tbUserProject] &amp;quot; _&amp;amp; &amp;quot;WHERE UserId = &amp;quot; &amp;amp; Session(&amp;quot;LogedUserId&amp;quot;) &amp;amp; &amp;quot;) And ProjectId = &amp;quot; &amp;amp; idPojektu &amp;amp; &amp;quot;&amp;quot;).ToList'wszystkie do danego usera'transportsPerUser = db.Database.SqlQuery(Of tbTransport)(&amp;quot;SELECT * FROM [16281468_general].[dbo].[tbTransport] WHERE ProjectId IN &amp;quot; _' &amp;amp; &amp;quot; (SELECT DISTINCT ProjectId FROM [16281468_general].[dbo].[tbUserProject] &amp;quot; _' &amp;amp; &amp;quot;WHERE UserId = &amp;quot; &amp;amp; Session(&amp;quot;LogedUserId&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;).ToListProjectsPerUser = db.Database.SqlQuery(Of tbProjekt)(&amp;quot;SELECT * FROM [16281468_general].[dbo].[tbProjekt] where Id IN&amp;quot; _&amp;amp; &amp;quot;(SELECT DISTINCT ProjectId FROM [16281468_general].[dbo].[tbUserProject] WHERE UserId = &amp;quot; &amp;amp; Session(&amp;quot;LogedUserId&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;).ToListEnd IfIf ProjectsPerUser.Count &amp;gt;= 0 ThenprojectsAndTransportsLists.Projects = ProjectsPerUserprojectsAndTransportsLists.Transports = transportsPerUser'projectsAndTransportsLists.DropDownSelectedItem = New SelectList(db.tbProjekt, &amp;quot;Id&amp;quot;, &amp;quot;Nazwa&amp;quot;, 10074)Return View(projectsAndTransportsLists)ElseReturn RedirectToAction(&amp;quot;Index&amp;quot;, &amp;quot;Login&amp;quot;)End IfElseReturn RedirectToAction(&amp;quot;Index&amp;quot;, &amp;quot;Login&amp;quot;)End IfElse'user zaznaczyl lub w drop downie znajduje sie tylko Select projectReturn RedirectToAction(&amp;quot;Index&amp;quot;, &amp;quot;Login&amp;quot;)End IfElseReturn RedirectToAction(&amp;quot;Index&amp;quot;, &amp;quot;Login&amp;quot;)End IfEnd Function&lt;/pre&gt;&lt;p&gt;&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;This is modele clas i am using:&lt;/p&gt;&lt;pre class="prettyprint lang-vb"&gt;Public Class CustomModelProjetsTransportsPublic Projects As IEnumerable(Of woitgroup_transport.tbProjekt)Public Transports As IEnumerable(Of woitgroup_transport.tbTransport)End Class&lt;/pre&gt;&lt;p&gt;&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;This is view (at the top i am passing model)::&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class="prettyprint lang-vb"&gt;@ModelType woitgroup_transport.CustomModelProjetsTransports&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;and begin form i added:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class="prettyprint lang-vb"&gt;@Using (Html.BeginForm(&amp;quot;Index&amp;quot;, &amp;quot;Transport&amp;quot;, FormMethod.Post))@Html.DropDownListFor(Function(Model) Model.Projects, New SelectList(Model.Projects, &amp;quot;Id&amp;quot;, &amp;quot;Nazwa&amp;quot;), &amp;quot;Select project&amp;quot;, New With {.class = &amp;quot;btn btn-primary dropdown-toggle&amp;quot;}) @&amp;lt;button type=&amp;quot;submit&amp;quot; class=&amp;quot;btn btn-success&amp;quot; value=&amp;quot;Submit&amp;quot; data-toggle=&amp;quot;modal&amp;quot; data-target=&amp;quot;#myModal&amp;quot;&amp;gt;&amp;lt;i class=&amp;quot;icon-circle-arrow-right icon-large&amp;quot;&amp;gt;&amp;lt;/i&amp;gt; Select&amp;lt;/button&amp;gt;&lt;/pre&gt;&lt;p&gt;&lt;br&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;that way this is working but how can i convert it to post back model instead of FormCollection? Hope that;s enough for you to hlp me out. Thanks&lt;/p&gt;&lt;p&gt;&lt;/p&gt;</description><a10:updated>2015-12-09T08:17:55-08:00</a10:updated></item></channel></rss>